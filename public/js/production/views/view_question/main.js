define(["backbone.custom","marionette.custom","views/common/question","forms/answer_edit","models/answer","views/view_question/answer","views/common/load_more"],function(e,t,n,r,i,s,o){var u=t.Layout.extend({template:function(){},events:{"click .js-send":"onSend","click .js-refresh":"onClickRefresh"},ui:{question:".js-question",answerForm:".js-answer-form",answerList:".js-answer-list"},initialize:function(){var e=this;this.answer=new i,this.answer.set("question_id",this.model.id),this.answerForm=new r({model:this.answer}),this.answersView=new o({model:this.model,collection:this.model.get("answers"),el:this.ui.answerList,itemView:s,modelData:{question_id:"id"}}),this.listenTo(this.answersView,"fetch",function(t){e.model.set("answer_count",t.pagination.total)}),this.questionView=new n({model:this.model,el:this.ui.question})},onRender:function(){this.questionView.render(),this.answerForm.buildControl("content",this.ui.answerForm,{}),this.answersView.render()},onSend:function(e){var t=this,n=$(e.currentTarget);n.bsbutton("loading"),this.answer.save().complete(function(){n.bsbutton("reset")}).success(function(){t.answerForm.getControl("content").markdownEditor.setValue(""),t.answer.id=void 0,t.onClickRefresh()})},onClickRefresh:function(e){this.answersView.triggerMethod("refresh")}});return u});