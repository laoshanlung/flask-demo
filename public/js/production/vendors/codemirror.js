window.CodeMirror=function(){function e(n,r){if(!(this instanceof e))return new e(n,r);this.options=r=r||{};for(var i in ys)!r.hasOwnProperty(i)&&ys.hasOwnProperty(i)&&(r[i]=ys[i]);p(r);var s="string"==typeof r.value?0:r.value.first,o=this.display=t(n,s);o.wrapper.CodeMirror=this,l(this),r.autofocus&&!Yi&&vt(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,draggingText:!1,highlight:new ri},a(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");var u=r.value;"string"==typeof u&&(u=new Ds(r.value,r.mode)),ut(this,Sr)(this,u),ji&&setTimeout(hi(dt,this,!0),20),gt(this);var f;try{f=document.activeElement==o.input}catch(c){}f||r.autofocus&&!Yi?setTimeout(hi(Bt,this),20):jt(this),ut(this,function(){for(var e in gs)gs.propertyIsEnumerable(e)&&gs[e](this,r[e],bs);for(var t=0;t<xs.length;++t)xs[t](this)})()}function t(e,t){var n={},r=n.input=mi("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none; font-size: 4px;");return Ui?r.style.width="1000px":r.setAttribute("wrap","off"),Gi&&(r.style.border="1px solid black"),r.setAttribute("autocorrect","off"),r.setAttribute("autocapitalize","off"),r.setAttribute("spellcheck","false"),n.inputDiv=mi("div",[r],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),n.scrollbarH=mi("div",[mi("div",null,null,"height: 1px")],"CodeMirror-hscrollbar"),n.scrollbarV=mi("div",[mi("div",null,null,"width: 1px")],"CodeMirror-vscrollbar"),n.scrollbarFiller=mi("div",null,"CodeMirror-scrollbar-filler"),n.gutterFiller=mi("div",null,"CodeMirror-gutter-filler"),n.lineDiv=mi("div",null,"CodeMirror-code"),n.selectionDiv=mi("div",null,null,"position: relative; z-index: 1"),n.cursor=mi("div"," ","CodeMirror-cursor"),n.otherCursor=mi("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"),n.measure=mi("div",null,"CodeMirror-measure"),n.lineSpace=mi("div",[n.measure,n.selectionDiv,n.lineDiv,n.cursor,n.otherCursor],null,"position: relative; outline: none"),n.mover=mi("div",[mi("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=mi("div",[n.mover],"CodeMirror-sizer"),n.heightForcer=mi("div",null,null,"position: absolute; height: "+Fs+"px; width: 1px;"),n.gutters=mi("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=mi("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=mi("div",[n.inputDiv,n.scrollbarH,n.scrollbarV,n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),Fi&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),e.appendChild?e.appendChild(n.wrapper):e(n.wrapper),Gi&&(r.style.width="0px"),Ui||(n.scroller.draggable=!0),$i?(n.inputDiv.style.height="1px",n.inputDiv.style.position="absolute"):Fi&&(n.scrollbarH.style.minWidth=n.scrollbarV.style.minWidth="18px"),n.viewOffset=n.lastSizeC=0,n.showingFrom=n.showingTo=t,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.prevInput="",n.alignWidgets=!1,n.pollingFast=!1,n.poll=new ri,n.cachedCharWidth=n.cachedTextHeight=null,n.measureLineCache=[],n.measureLineCachePos=0,n.inaccurateSelection=!1,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n}function n(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),r(t)}function r(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,D(e,100),e.state.modeGen++,e.curOp&&lt(e)}function i(e){e.options.lineWrapping?(e.display.wrapper.className+=" CodeMirror-wrap",e.display.sizer.style.minWidth=""):(e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-wrap",""),h(e)),o(e),lt(e),$(e),setTimeout(function(){d(e)},100)}function s(e){var t=rt(e.display),n=e.options.lineWrapping,r=n&&Math.max(5,e.display.scroller.clientWidth/it(e.display)-3);return function(i){return Gn(e.doc,i)?0:n?(Math.ceil(i.text.length/r)||1)*t:t}}function o(e){var t=e.doc,n=s(e);t.iter(function(e){var t=n(e);t!=e.height&&Cr(e,t)})}function u(e){var t=Cs[e.options.keyMap],n=t.style;e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(n?" cm-keymap-"+n:"")}function a(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),$(e)}function f(e){l(e),lt(e),setTimeout(function(){m(e)},20)}function l(e){var t=e.display.gutters,n=e.options.gutters;gi(t);for(var r=0;r<n.length;++r){var i=n[r],s=t.appendChild(mi("div",null,"CodeMirror-gutter "+i));"CodeMirror-linenumbers"==i&&(e.display.lineGutter=s,s.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=r?"":"none"}function c(e,t){if(0==t.height)return 0;for(var n,r=t.text.length,i=t;n=$n(i);){var s=n.find();i=xr(e,s.from.line),r+=s.from.ch-s.to.ch}for(i=t;n=Jn(i);){var s=n.find();r-=i.text.length-s.from.ch,i=xr(e,s.to.line),r+=i.text.length-s.to.ch}return r}function h(e){var t=e.display,n=e.doc;t.maxLine=xr(n,n.first),t.maxLineLength=c(n,t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var r=c(n,e);r>t.maxLineLength&&(t.maxLineLength=r,t.maxLine=e)})}function p(e){var t=ai(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function d(e){var t=e.display,n=e.doc.height,r=n+F(t);t.sizer.style.minHeight=t.heightForcer.style.top=r+"px",t.gutters.style.height=Math.max(r,t.scroller.clientHeight-Fs)+"px";var i=Math.max(r,t.scroller.scrollHeight),s=t.scroller.scrollWidth>t.scroller.clientWidth+1,o=i>t.scroller.clientHeight+1;o?(t.scrollbarV.style.display="block",t.scrollbarV.style.bottom=s?Si(t.measure)+"px":"0",t.scrollbarV.firstChild.style.height=Math.max(0,i-t.scroller.clientHeight+t.scrollbarV.clientHeight)+"px"):(t.scrollbarV.style.display="",t.scrollbarV.firstChild.style.height="0"),s?(t.scrollbarH.style.display="block",t.scrollbarH.style.right=o?Si(t.measure)+"px":"0",t.scrollbarH.firstChild.style.width=t.scroller.scrollWidth-t.scroller.clientWidth+t.scrollbarH.clientWidth+"px"):(t.scrollbarH.style.display="",t.scrollbarH.firstChild.style.width="0"),s&&o?(t.scrollbarFiller.style.display="block",t.scrollbarFiller.style.height=t.scrollbarFiller.style.width=Si(t.measure)+"px"):t.scrollbarFiller.style.display="",s&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(t.gutterFiller.style.display="block",t.gutterFiller.style.height=Si(t.measure)+"px",t.gutterFiller.style.width=t.gutters.offsetWidth+"px"):t.gutterFiller.style.display="",Ji&&0===Si(t.measure)&&(t.scrollbarV.style.minWidth=t.scrollbarH.style.minHeight=Ki?"18px":"12px",t.scrollbarV.style.pointerEvents=t.scrollbarH.style.pointerEvents="none")}function v(e,t,n){var r=e.scroller.scrollTop,i=e.wrapper.clientHeight;"number"==typeof n?r=n:n&&(r=n.top,i=n.bottom-n.top),r=Math.floor(r-j(e));var s=Math.ceil(r+i);return{from:Lr(t,r),to:Lr(t,s)}}function m(e){var t=e.display;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var n=b(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,i=n+"px",s=t.lineDiv.firstChild;s;s=s.nextSibling)if(s.alignable)for(var o=0,u=s.alignable;o<u.length;++o)u[o].style.left=i;e.options.fixedGutter&&(t.gutters.style.left=n+r+"px")}}function g(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=y(e.options,t.first+t.size-1),r=e.display;if(n.length!=r.lineNumChars){var i=r.measure.appendChild(mi("div",[mi("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),s=i.firstChild.offsetWidth,o=i.offsetWidth-s;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(s,r.lineGutter.offsetWidth-o),r.lineNumWidth=r.lineNumInnerWidth+o,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",!0}return!1}function y(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function b(e){return wi(e.scroller).left-wi(e.sizer).left}function w(e,t,n,r){for(var i,s=e.display.showingFrom,o=e.display.showingTo,u=v(e.display,e.doc,n),a=!0;;a=!1){var f=e.display.scroller.clientWidth;if(!E(e,t,u,r))break;if(i=!0,t=[],A(e),d(e),a&&e.options.lineWrapping&&f!=e.display.scroller.clientWidth)r=!0;else if(r=!1,n&&(n=Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,"number"==typeof n?n:n.top)),u=v(e.display,e.doc,n),u.from>=e.display.showingFrom&&u.to<=e.display.showingTo)break}return i&&(Yr(e,"update",e),(e.display.showingFrom!=s||e.display.showingTo!=o)&&Yr(e,"viewportChange",e,e.display.showingFrom,e.display.showingTo)),i}function E(e,t,n,r){var i=e.display,s=e.doc;if(!i.wrapper.offsetWidth)return i.showingFrom=i.showingTo=s.first,i.viewOffset=0,void 0;if(!(!r&&0==t.length&&n.from>i.showingFrom&&n.to<i.showingTo)){g(e)&&(t=[{from:s.first,to:s.first+s.size}]);var o=i.sizer.style.marginLeft=i.gutters.offsetWidth+"px";i.scrollbarH.style.left=e.options.fixedGutter?o:"0";var u=1/0;if(e.options.lineNumbers)for(var a=0;a<t.length;++a)t[a].diff&&t[a].from<u&&(u=t[a].from);var f=s.first+s.size,l=Math.max(n.from-e.options.viewportMargin,s.first),c=Math.min(f,n.to+e.options.viewportMargin);if(i.showingFrom<l&&l-i.showingFrom<20&&(l=Math.max(s.first,i.showingFrom)),i.showingTo>c&&i.showingTo-c<20&&(c=Math.min(f,i.showingTo)),as)for(l=kr(Qn(s,xr(s,l)));f>c&&Gn(s,xr(s,c));)++c;var h=[{from:Math.max(i.showingFrom,s.first),to:Math.min(i.showingTo,f)}];if(h=h[0].from>=h[0].to?[]:T(h,t),as)for(var a=0;a<h.length;++a)for(var p,d=h[a];p=Jn(xr(s,d.to-1));){var v=p.find().from.line;if(!(v>d.from)){h.splice(a--,1);break}d.to=v}for(var m=0,a=0;a<h.length;++a){var d=h[a];d.from<l&&(d.from=l),d.to>c&&(d.to=c),d.from>=d.to?h.splice(a--,1):m+=d.to-d.from}if(!r&&m==c-l&&l==i.showingFrom&&c==i.showingTo)return x(e),void 0;h.sort(function(e,t){return e.from-t.from});try{var y=document.activeElement}catch(b){}.7*(c-l)>m&&(i.lineDiv.style.display="none"),C(e,l,c,h,u),i.lineDiv.style.display="",y&&document.activeElement!=y&&y.offsetHeight&&y.focus();var w=l!=i.showingFrom||c!=i.showingTo||i.lastSizeC!=i.wrapper.clientHeight;return w&&(i.lastSizeC=i.wrapper.clientHeight,D(e,400)),i.showingFrom=l,i.showingTo=c,i.gutters.style.height="",S(e),x(e),!0}}function S(e){for(var t,n=e.display,r=n.lineDiv.offsetTop,i=n.lineDiv.firstChild;i;i=i.nextSibling)if(i.lineObj){if(Fi){var s=i.offsetTop+i.offsetHeight;t=s-r,r=s}else{var o=wi(i);t=o.bottom-o.top}var u=i.lineObj.height-t;if(2>t&&(t=rt(n)),u>.001||-0.001>u){Cr(i.lineObj,t);var a=i.lineObj.widgets;if(a)for(var f=0;f<a.length;++f)a[f].height=a[f].node.offsetHeight}}}function x(e){var t=e.display.viewOffset=Ar(e,xr(e.doc,e.display.showingFrom));e.display.mover.style.top=t+"px"}function T(e,t){for(var n=0,r=t.length||0;r>n;++n){for(var i=t[n],s=[],o=i.diff||0,u=0,a=e.length;a>u;++u){var f=e[u];i.to<=f.from&&i.diff?s.push({from:f.from+o,to:f.to+o}):i.to<=f.from||i.from>=f.to?s.push(f):(i.from>f.from&&s.push({from:f.from,to:i.from}),i.to<f.to&&s.push({from:i.to+o,to:f.to+o}))}e=s}return e}function N(e){for(var t=e.display,n={},r={},i=t.gutters.firstChild,s=0;i;i=i.nextSibling,++s)n[e.options.gutters[s]]=i.offsetLeft,r[e.options.gutters[s]]=i.offsetWidth;return{fixedPos:b(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function C(e,t,n,r,i){function s(t){var n=t.nextSibling;return Ui&&Zi&&e.display.currentWheelTarget==t?(t.style.display="none",t.lineObj=null):t.parentNode.removeChild(t),n}var o=N(e),u=e.display,a=e.options.lineNumbers;r.length||Ui&&e.display.currentWheelTarget||gi(u.lineDiv);var f=u.lineDiv,l=f.firstChild,c=r.shift(),h=t;for(e.doc.iter(t,n,function(t){if(c&&c.to==h&&(c=r.shift()),Gn(e.doc,t)){if(0!=t.height&&Cr(t,0),t.widgets&&l&&l.previousSibling)for(var n=0;n<t.widgets.length;++n){var u=t.widgets[n];if(u.showIfHidden){var p=l.previousSibling;if(/pre/i.test(p.nodeName)){var d=mi("div",null,null,"position: relative");p.parentNode.replaceChild(d,p),d.appendChild(p),p=d}var v=p.appendChild(mi("div",[u.node],"CodeMirror-linewidget"));u.handleMouseEvents||(v.ignoreEvents=!0),L(u,v,p,o)}}}else if(c&&c.from<=h&&c.to>h){for(;l.lineObj!=t;)l=s(l);a&&h>=i&&l.lineNumber&&bi(l.lineNumber,y(e.options,h)),l=l.nextSibling}else{if(t.widgets)for(var m,g=0,b=l;b&&20>g;++g,b=b.nextSibling)if(b.lineObj==t&&/div/i.test(b.nodeName)){m=b;break}var w=k(e,t,h,o,m);if(w!=m)f.insertBefore(w,l);else{for(;l!=m;)l=s(l);l=l.nextSibling}w.lineObj=t}++h});l;)l=s(l)}function k(e,t,n,r,i){var s,o=cr(e,t),u=o.pre,a=t.gutterMarkers,f=e.display,l=o.bgClass?o.bgClass+" "+(t.bgClass||""):t.bgClass;if(!(e.options.lineNumbers||a||l||t.wrapClass||t.widgets))return u;if(i){i.alignable=null;for(var c,h=!0,p=0,d=null,v=i.firstChild;v;v=c)if(c=v.nextSibling,/\bCodeMirror-linewidget\b/.test(v.className)){for(var m=0;m<t.widgets.length;++m){var g=t.widgets[m];if(g.node==v.firstChild){g.above||d||(d=v),L(g,v,i,r),++p;break}}if(m==t.widgets.length){h=!1;break}}else i.removeChild(v);i.insertBefore(u,d),h&&p==t.widgets.length&&(s=i,i.className=t.wrapClass||"")}if(s||(s=mi("div",null,t.wrapClass,"position: relative"),s.appendChild(u)),l&&s.insertBefore(mi("div",null,l+" CodeMirror-linebackground"),s.firstChild),e.options.lineNumbers||a){var b=s.insertBefore(mi("div",null,"CodeMirror-gutter-wrapper","position: absolute; left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px"),u);if(e.options.fixedGutter&&(s.alignable||(s.alignable=[])).push(b),!e.options.lineNumbers||a&&a["CodeMirror-linenumbers"]||(s.lineNumber=b.appendChild(mi("div",y(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+f.lineNumInnerWidth+"px"))),a)for(var w=0;w<e.options.gutters.length;++w){var E=e.options.gutters[w],S=a.hasOwnProperty(E)&&a[E];S&&b.appendChild(mi("div",[S],"CodeMirror-gutter-elt","left: "+r.gutterLeft[E]+"px; width: "+r.gutterWidth[E]+"px"))}}if(Fi&&(s.style.zIndex=2),t.widgets&&s!=i)for(var m=0,x=t.widgets;m<x.length;++m){var g=x[m],T=mi("div",[g.node],"CodeMirror-linewidget");g.handleMouseEvents||(T.ignoreEvents=!0),L(g,T,s,r),g.above?s.insertBefore(T,e.options.lineNumbers&&0!=t.height?b:u):s.appendChild(T),Yr(g,"redraw")}return s}function L(e,t,n,r){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var i=r.wrapperWidth;t.style.left=r.fixedPos+"px",e.coverGutter||(i-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px"),t.style.width=i+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function A(e){var t=e.display,n=Qt(e.doc.sel.from,e.doc.sel.to);if(n||e.options.showCursorWhenSelecting?O(e):t.cursor.style.display=t.otherCursor.style.display="none",n?t.selectionDiv.style.display="none":M(e),e.options.moveInputWithCursor){var r=Z(e,e.doc.sel.head,"div"),i=wi(t.wrapper),s=wi(t.lineDiv);t.inputDiv.style.top=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+s.top-i.top))+"px",t.inputDiv.style.left=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+s.left-i.left))+"px"}}function O(e){var t=e.display,n=Z(e,e.doc.sel.head,"div");t.cursor.style.left=n.left+"px",t.cursor.style.top=n.top+"px",t.cursor.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",t.cursor.style.display="",n.other?(t.otherCursor.style.display="",t.otherCursor.style.left=n.other.left+"px",t.otherCursor.style.top=n.other.top+"px",t.otherCursor.style.height=.85*(n.other.bottom-n.other.top)+"px"):t.otherCursor.style.display="none"}function M(e){function t(e,t,n,r){0>t&&(t=0),o.appendChild(mi("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==n?u-e:n)+"px; height: "+(r-t)+"px"))}function n(n,r,s){function o(t,r){return Y(e,Kt(n,t),"div",c,r)}var f,l,c=xr(i,n),h=c.text.length;return Ti(Or(c),r||0,null==s?h:s,function(e,n,i){var c,p,d,v=o(e,"left");if(e==n)c=v,p=d=v.left;else{if(c=o(n-1,"right"),"rtl"==i){var m=v;v=c,c=m}p=v.left,d=c.right}null==r&&0==e&&(p=a),c.top-v.top>3&&(t(p,v.top,null,v.bottom),p=a,v.bottom<c.top&&t(p,v.bottom,null,c.top)),null==s&&n==h&&(d=u),(!f||v.top<f.top||v.top==f.top&&v.left<f.left)&&(f=v),(!l||c.bottom>l.bottom||c.bottom==l.bottom&&c.right>l.right)&&(l=c),a+1>p&&(p=a),t(p,c.top,d-p,c.bottom)}),{start:f,end:l}}var r=e.display,i=e.doc,s=e.doc.sel,o=document.createDocumentFragment(),u=r.lineSpace.offsetWidth,a=I(e.display);if(s.from.line==s.to.line)n(s.from.line,s.from.ch,s.to.ch);else{var f=xr(i,s.from.line),l=xr(i,s.to.line),c=Qn(i,f)==Qn(i,l),h=n(s.from.line,s.from.ch,c?f.text.length:null).end,p=n(s.to.line,c?0:null,s.to.ch).start;c&&(h.top<p.top-2?(t(h.right,h.top,null,h.bottom),t(a,p.top,p.left,p.bottom)):t(h.right,h.top,p.left-h.right,h.bottom)),h.bottom<p.top&&t(a,h.bottom,null,p.top)}yi(r.selectionDiv,o),r.selectionDiv.style.display=""}function _(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursor.style.visibility=t.otherCursor.style.visibility="",e.options.cursorBlinkRate>0&&(t.blinker=setInterval(function(){t.cursor.style.visibility=t.otherCursor.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate))}}function D(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.showingTo&&e.state.highlight.set(t,hi(P,e))}function P(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.showingTo)){var n,r=+(new Date)+e.options.workTime,i=xn(t.mode,B(e,t.frontier)),s=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.showingTo+500),function(o){if(t.frontier>=e.display.showingFrom){var u=o.styles;o.styles=ur(e,o,i,!0);for(var a=!u||u.length!=o.styles.length,f=0;!a&&f<u.length;++f)a=u[f]!=o.styles[f];a&&(n&&n.end==t.frontier?n.end++:s.push(n={start:t.frontier,end:t.frontier+1})),o.stateAfter=xn(t.mode,i)}else fr(e,o.text,i),o.stateAfter=0==t.frontier%5?xn(t.mode,i):null;return++t.frontier,+(new Date)>r?(D(e,e.options.workDelay),!0):void 0}),s.length&&ut(e,function(){for(var e=0;e<s.length;++e)lt(this,s[e].start,s[e].end)})()}}function H(e,t,n){for(var r,i,s=e.doc,o=n?-1:t-(e.doc.mode.innerMode?1e3:100),u=t;u>o;--u){if(u<=s.first)return s.first;var a=xr(s,u-1);if(a.stateAfter&&(!n||u<=s.frontier))return u;var f=ii(a.text,null,e.options.tabSize);(null==i||r>f)&&(i=u-1,r=f)}return i}function B(e,t,n){var r=e.doc,i=e.display;if(!r.mode.startState)return!0;var s=H(e,t,n),o=s>r.first&&xr(r,s-1).stateAfter;return o=o?xn(r.mode,o):Tn(r.mode),r.iter(s,t,function(n){fr(e,n.text,o);var u=s==t-1||0==s%5||s>=i.showingFrom&&s<i.showingTo;n.stateAfter=u?xn(r.mode,o):null,++s}),n&&(r.frontier=s),o}function j(e){return e.lineSpace.offsetTop}function F(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function I(e){var t=yi(e.measure,mi("pre",null,null,"text-align: left")).appendChild(mi("span","x"));return t.offsetLeft}function q(e,t,n,r,i){var s=-1;if(r=r||z(e,t),r.crude){var o=r.left+n*r.width;return{left:o,right:o+r.width,top:r.top,bottom:r.bottom}}for(var u=n;;u+=s){var a=r[u];if(a)break;0>s&&0==u&&(s=1)}return i=u>n?"left":n>u?"right":i,"left"==i&&a.leftSide?a=a.leftSide:"right"==i&&a.rightSide&&(a=a.rightSide),{left:n>u?a.right:a.left,right:u>n?a.left:a.right,top:a.top,bottom:a.bottom}}function R(e,t){for(var n=e.display.measureLineCache,r=0;r<n.length;++r){var i=n[r];if(i.text==t.text&&i.markedSpans==t.markedSpans&&e.display.scroller.clientWidth==i.width&&i.classes==t.textClass+"|"+t.wrapClass)return i}}function U(e,t){var n=R(e,t);n&&(n.text=n.measure=n.markedSpans=null)}function z(e,t){var n=R(e,t);if(n)return n.measure;var r=W(e,t),i=e.display.measureLineCache,s={text:t.text,width:e.display.scroller.clientWidth,markedSpans:t.markedSpans,measure:r,classes:t.textClass+"|"+t.wrapClass};return 16==i.length?i[++e.display.measureLineCachePos%16]=s:i.push(s),r}function W(e,t){function n(e){var t=e.top-d.top,n=e.bottom-d.top;n>g&&(n=g),0>t&&(t=0);for(var r=v.length-2;r>=0;r-=2){var i=v[r],s=v[r+1];if(!(i>n||t>s)&&(t>=i&&s>=n||i>=t&&n>=s||Math.min(n,s)-Math.max(t,i)>=n-t>>1)){v[r]=Math.min(t,i),v[r+1]=Math.max(n,s);break}}return 0>r&&(r=v.length,v.push(t,n)),{left:e.left-d.left,right:e.right-d.left,top:r,bottom:null}}function r(e){e.bottom=v[e.top+1],e.top=v[e.top]}if(!e.options.lineWrapping&&t.text.length>=e.options.crudeMeasuringFrom)return X(e,t);var i=e.display,s=ci(t.text.length),o=cr(e,t,s,!0).pre;if(ji&&!Fi&&!e.options.lineWrapping&&o.childNodes.length>100){for(var u=document.createDocumentFragment(),a=10,f=o.childNodes.length,l=0,c=Math.ceil(f/a);c>l;++l){for(var h=mi("div",null,null,"display: inline-block"),p=0;a>p&&f;++p)h.appendChild(o.firstChild),--f;u.appendChild(h)}o.appendChild(u)}yi(i.measure,o);var d=wi(i.lineDiv),v=[],m=ci(t.text.length),g=o.offsetHeight;Ii&&i.measure.first!=o&&yi(i.measure,o);for(var y,l=0;l<s.length;++l)if(y=s[l]){var b=y,w=null;if(/\bCodeMirror-widget\b/.test(y.className)&&y.getClientRects){1==y.firstChild.nodeType&&(b=y.firstChild);var E=b.getClientRects();E.length>1&&(w=m[l]=n(E[0]),w.rightSide=n(E[E.length-1]))}w||(w=m[l]=n(wi(b))),y.measureRight&&(w.right=wi(y.measureRight).left-d.left),y.leftSide&&(w.leftSide=n(wi(y.leftSide)))}gi(e.display.measure);for(var y,l=0;l<m.length;++l)(y=m[l])&&(r(y),y.leftSide&&r(y.leftSide),y.rightSide&&r(y.rightSide));return m}function X(e,t){var n=new As(t.text.slice(0,100),null);t.textClass&&(n.textClass=t.textClass);var r=W(e,n),i=q(e,n,0,r,"left"),s=q(e,n,99,r,"right");return{crude:!0,top:i.top,left:i.left,bottom:i.bottom,width:(s.right-i.left)/100}}function V(e,t){var n=!1;if(t.markedSpans)for(var r=0;r<t.markedSpans;++r){var i=t.markedSpans[r];!i.collapsed||null!=i.to&&i.to!=t.text.length||(n=!0)}var s=!n&&R(e,t);if(s||t.text.length>=e.options.crudeMeasuringFrom)return q(e,t,t.text.length,s&&s.measure,"right").right;var o=cr(e,t,null,!0).pre,u=o.appendChild(xi(e.display.measure));return yi(e.display.measure,o),wi(u).right-wi(e.display.lineDiv).left}function $(e){e.display.measureLineCache.length=e.display.measureLineCachePos=0,e.display.cachedCharWidth=e.display.cachedTextHeight=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function J(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function K(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function Q(e,t,n,r){if(t.widgets)for(var i=0;i<t.widgets.length;++i)if(t.widgets[i].above){var s=nr(t.widgets[i]);n.top+=s,n.bottom+=s}if("line"==r)return n;r||(r="local");var o=Ar(e,t);if("local"==r?o+=j(e.display):o-=e.display.viewOffset,"page"==r||"window"==r){var u=wi(e.display.lineSpace);o+=u.top+("window"==r?0:K());var a=u.left+("window"==r?0:J());n.left+=a,n.right+=a}return n.top+=o,n.bottom+=o,n}function G(e,t,n){if("div"==n)return t;var r=t.left,i=t.top;if("page"==n)r-=J(),i-=K();else if("local"==n||!n){var s=wi(e.display.sizer);r+=s.left,i+=s.top}var o=wi(e.display.lineSpace);return{left:r-o.left,top:i-o.top}}function Y(e,t,n,r,i){return r||(r=xr(e.doc,t.line)),Q(e,r,q(e,r,t.ch,null,i),n)}function Z(e,t,n,r,i){function s(t,s){var o=q(e,r,t,i,s?"right":"left");return s?o.left=o.right:o.right=o.left,Q(e,r,o,n)}function o(e,t){var n=u[t],r=n.level%2;return e==Ni(n)&&t&&n.level<u[t-1].level?(n=u[--t],e=Ci(n)-(n.level%2?0:1),r=!0):e==Ci(n)&&t<u.length-1&&n.level<u[t+1].level&&(n=u[++t],e=Ni(n)-n.level%2,r=!1),r&&e==n.to&&e>n.from?s(e-1):s(e,r)}r=r||xr(e.doc,t.line),i||(i=z(e,r));var u=Or(r),a=t.ch;if(!u)return s(a);var f=_i(u,a),l=o(a,f);return null!=Qs&&(l.other=o(a,Qs)),l}function et(e,t,n,r){var i=new Kt(e,t);return i.xRel=r,n&&(i.outside=!0),i}function tt(e,t,n){var r=e.doc;if(n+=e.display.viewOffset,0>n)return et(r.first,0,!0,-1);var i=Lr(r,n),s=r.first+r.size-1;if(i>s)return et(r.first+r.size-1,xr(r,s).text.length,!0,1);for(0>t&&(t=0);;){var o=xr(r,i),u=nt(e,o,i,t,n),a=Jn(o),f=a&&a.find();if(!a||!(u.ch>f.from.ch||u.ch==f.from.ch&&u.xRel>0))return u;i=f.to.line}}function nt(e,t,n,r,i){function s(r){var i=Z(e,Kt(n,r),"line",t,f);return u=!0,o>i.bottom?i.left-a:o<i.top?i.left+a:(u=!1,i.left)}var o=i-Ar(e,t),u=!1,a=2*e.display.wrapper.clientWidth,f=z(e,t),l=Or(t),c=t.text.length,h=ki(t),p=Li(t),d=s(h),v=u,m=s(p),g=u;if(r>m)return et(n,p,g,1);for(;;){if(l?p==h||p==Pi(t,h,1):1>=p-h){for(var y=d>r||m-r>=r-d?h:p,b=r-(y==h?d:m);vi(t.text.charAt(y));)++y;var w=et(n,y,y==h?v:g,0>b?-1:b?1:0);return w}var E=Math.ceil(c/2),S=h+E;if(l){S=h;for(var x=0;E>x;++x)S=Pi(t,S,1)}var T=s(S);T>r?(p=S,m=T,(g=u)&&(m+=1e3),c=E):(h=S,d=T,v=u,c-=E)}}function rt(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==ns){ns=mi("pre");for(var t=0;49>t;++t)ns.appendChild(document.createTextNode("x")),ns.appendChild(mi("br"));ns.appendChild(document.createTextNode("x"))}yi(e.measure,ns);var n=ns.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),gi(e.measure),n||1}function it(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=mi("span","x"),n=mi("pre",[t]);yi(e.measure,n);var r=t.offsetWidth;return r>2&&(e.cachedCharWidth=r),r||10}function st(e){e.curOp={changes:[],forceUpdate:!1,updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,cursorActivity:!1,updateMaxLine:!1,updateScrollPos:!1,id:++fs},js++||(Bs=[])}function ot(e){var t=e.curOp,n=e.doc,r=e.display;if(e.curOp=null,t.updateMaxLine&&h(e),r.maxLineChanged&&!e.options.lineWrapping&&r.maxLine){var i=V(e,r.maxLine);r.sizer.style.minWidth=Math.max(0,i+3+Fs)+"px",r.maxLineChanged=!1;var s=Math.max(0,r.sizer.offsetLeft+r.sizer.offsetWidth-r.scroller.clientWidth);s<n.scrollLeft&&!t.updateScrollPos&&kt(e,Math.min(r.scroller.scrollLeft,s),!0)}var o,u;if(t.updateScrollPos)o=t.updateScrollPos;else if(t.selectionChanged&&r.scroller.clientHeight){var a=Z(e,n.sel.head);o=pn(e,a.left,a.top,a.left,a.bottom)}if((t.changes.length||t.forceUpdate||o&&null!=o.scrollTop)&&(u=w(e,t.changes,o&&o.scrollTop,t.forceUpdate),e.display.scroller.offsetHeight&&(e.doc.scrollTop=e.display.scroller.scrollTop)),!u&&t.selectionChanged&&A(e),t.updateScrollPos){var f=Math.max(0,Math.min(r.scroller.scrollHeight-r.scroller.clientHeight,o.scrollTop)),l=Math.max(0,Math.min(r.scroller.scrollWidth-r.scroller.clientWidth,o.scrollLeft));r.scroller.scrollTop=r.scrollbarV.scrollTop=n.scrollTop=f,r.scroller.scrollLeft=r.scrollbarH.scrollLeft=n.scrollLeft=l,m(e),t.scrollToPos&&cn(e,tn(e.doc,t.scrollToPos.from),tn(e.doc,t.scrollToPos.to),t.scrollToPos.margin)}else o&&ln(e);t.selectionChanged&&_(e),e.state.focused&&t.updateInput&&dt(e,t.userSelChange);var c=t.maybeHiddenMarkers,p=t.maybeUnhiddenMarkers;if(c)for(var d=0;d<c.length;++d)c[d].lines.length||Gr(c[d],"hide");if(p)for(var d=0;d<p.length;++d)p[d].lines.length&&Gr(p[d],"unhide");var v;if(--js||(v=Bs,Bs=null),t.textChanged&&Gr(e,"change",e,t.textChanged),t.cursorActivity&&Gr(e,"cursorActivity",e),v)for(var d=0;d<v.length;++d)v[d]()}function ut(e,t){return function(){var n=e||this,r=!n.curOp;r&&st(n);try{var i=t.apply(n,arguments)}finally{r&&ot(n)}return i}}function at(e){return function(){var t,n=this.cm&&!this.cm.curOp;n&&st(this.cm);try{t=e.apply(this,arguments)}finally{n&&ot(this.cm)}return t}}function ft(e,t){var n,r=!e.curOp;r&&st(e);try{n=t()}finally{r&&ot(e)}return n}function lt(e,t,n,r){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),e.curOp.changes.push({from:t,to:n,diff:r})}function ct(e){e.display.pollingFast||e.display.poll.set(e.options.pollInterval,function(){pt(e),e.state.focused&&ct(e)})}function ht(e){function t(){var r=pt(e);r||n?(e.display.pollingFast=!1,ct(e)):(n=!0,e.display.poll.set(60,t))}var n=!1;e.display.pollingFast=!0,e.display.poll.set(20,t)}function pt(e){var t=e.display.input,n=e.display.prevInput,r=e.doc,i=r.sel;if(!e.state.focused||$s(t)||mt(e)||e.options.disableInput)return!1;e.state.pasteIncoming&&e.state.fakedLastChar&&(t.value=t.value.substring(0,t.value.length-1),e.state.fakedLastChar=!1);var s=t.value;if(s==n&&Qt(i.from,i.to))return!1;if(Ri&&!Ii&&e.display.inputHasSelection===s)return dt(e,!0),!1;var o=!e.curOp;o&&st(e),i.shift=!1;for(var u=0,a=Math.min(n.length,s.length);a>u&&n.charCodeAt(u)==s.charCodeAt(u);)++u;var f=i.from,l=i.to,c=s.slice(u);u<n.length?f=Kt(f.line,f.ch-(n.length-u)):e.state.overwrite&&Qt(f,l)&&!e.state.pasteIncoming&&(l=Kt(l.line,Math.min(xr(r,l.line).text.length,l.ch+c.length)));var h=e.curOp.updateInput,p={from:f,to:l,text:Vs(c),origin:e.state.pasteIncoming?"paste":e.state.cutIncoming?"cut":"+input"};if(Ut(e.doc,p,"end"),e.curOp.updateInput=h,Yr(e,"inputRead",e,p),c&&!e.state.pasteIncoming&&e.options.electricChars&&e.options.smartIndent&&i.head.ch<100){var d=e.getModeAt(i.head).electricChars;if(d)for(var v=0;v<d.length;v++)if(c.indexOf(d.charAt(v))>-1){mn(e,i.head.line,"smart");break}}return s.length>1e3||s.indexOf("\n")>-1?t.value=e.display.prevInput="":e.display.prevInput=s,o&&ot(e),e.state.pasteIncoming=e.state.cutIncoming=!1,!0}function dt(e,t){var n,r,i=e.doc;if(Qt(i.sel.from,i.sel.to))t&&(e.display.prevInput=e.display.input.value="",Ri&&!Ii&&(e.display.inputHasSelection=null));else{e.display.prevInput="",n=Js&&(i.sel.to.line-i.sel.from.line>100||(r=e.getSelection()).length>1e3);var s=n?"-":r||e.getSelection();e.display.input.value=s,e.state.focused&&ui(e.display.input),Ri&&!Ii&&(e.display.inputHasSelection=s)}e.display.inaccurateSelection=n}function vt(e){"nocursor"==e.options.readOnly||Yi&&document.activeElement==e.display.input||e.display.input.focus()}function mt(e){return e.options.readOnly||e.doc.cantEdit}function gt(e){function t(){e.state.focused&&setTimeout(hi(vt,e),0)}function n(){null==u&&(u=setTimeout(function(){u=null,o.cachedCharWidth=o.cachedTextHeight=Ws=null,$(e),ft(e,hi(lt,e))},100))}function r(){for(var e=o.wrapper.parentNode;e&&e!=document.body;e=e.parentNode);e?setTimeout(r,5e3):Qr(window,"resize",n)}function i(t){Zr(e,t)||e.options.onDragEvent&&e.options.onDragEvent(e,Ur(t))||Vr(t)}function s(t){o.inaccurateSelection&&(o.prevInput="",o.inaccurateSelection=!1,o.input.value=e.getSelection(),ui(o.input)),"cut"==t.type&&(e.state.cutIncoming=!0)}var o=e.display;Kr(o.scroller,"mousedown",ut(e,wt)),ji?Kr(o.scroller,"dblclick",ut(e,function(t){if(!Zr(e,t)){var n=bt(e,t);if(n&&!xt(e,t)&&!yt(e.display,t)){zr(t);var r=wn(xr(e.doc,n.line).text,n);sn(e.doc,r.from,r.to)}}})):Kr(o.scroller,"dblclick",function(t){Zr(e,t)||zr(t)}),Kr(o.lineSpace,"selectstart",function(e){yt(o,e)||zr(e)}),os||Kr(o.scroller,"contextmenu",function(t){Ft(e,t)}),Kr(o.scroller,"scroll",function(){o.scroller.clientHeight&&(Ct(e,o.scroller.scrollTop),kt(e,o.scroller.scrollLeft,!0),Gr(e,"scroll",e))}),Kr(o.scrollbarV,"scroll",function(){o.scroller.clientHeight&&Ct(e,o.scrollbarV.scrollTop)}),Kr(o.scrollbarH,"scroll",function(){o.scroller.clientHeight&&kt(e,o.scrollbarH.scrollLeft)}),Kr(o.scroller,"mousewheel",function(t){Lt(e,t)}),Kr(o.scroller,"DOMMouseScroll",function(t){Lt(e,t)}),Kr(o.scrollbarH,"mousedown",t),Kr(o.scrollbarV,"mousedown",t),Kr(o.wrapper,"scroll",function(){o.wrapper.scrollTop=o.wrapper.scrollLeft=0});var u;Kr(window,"resize",n),setTimeout(r,5e3),Kr(o.input,"keyup",ut(e,Dt)),Kr(o.input,"input",function(){Ri&&!Ii&&e.display.inputHasSelection&&(e.display.inputHasSelection=null),ht(e)}),Kr(o.input,"keydown",ut(e,Pt)),Kr(o.input,"keypress",ut(e,Ht)),Kr(o.input,"focus",hi(Bt,e)),Kr(o.input,"blur",hi(jt,e)),e.options.dragDrop&&(Kr(o.scroller,"dragstart",function(t){Nt(e,t)}),Kr(o.scroller,"dragenter",i),Kr(o.scroller,"dragover",i),Kr(o.scroller,"drop",ut(e,Tt))),Kr(o.scroller,"paste",function(t){yt(o,t)||(vt(e),ht(e))}),Kr(o.input,"paste",function(){if(Ui&&!e.state.fakedLastChar&&!(new Date-e.state.lastMiddleDown<200)){var t=o.input.selectionStart,n=o.input.selectionEnd;o.input.value+="$",o.input.selectionStart=t,o.input.selectionEnd=n,e.state.fakedLastChar=!0}e.state.pasteIncoming=!0,ht(e)}),Kr(o.input,"cut",s),Kr(o.input,"copy",s),$i&&Kr(o.sizer,"mouseup",function(){document.activeElement==o.input&&o.input.blur(),vt(e)})}function yt(e,t){for(var n=$r(t);n!=e.wrapper;n=n.parentNode)if(!n||n.ignoreEvents||n.parentNode==e.sizer&&n!=e.mover)return!0}function bt(e,t,n){var r=e.display;if(!n){var i=$r(t);if(i==r.scrollbarH||i==r.scrollbarH.firstChild||i==r.scrollbarV||i==r.scrollbarV.firstChild||i==r.scrollbarFiller||i==r.gutterFiller)return null}var s,o,u=wi(r.lineSpace);try{s=t.clientX,o=t.clientY}catch(t){return null}return tt(e,s-u.left,o-u.top)}function wt(e){function t(e){if(!Qt(g,e)){if(g=e,"single"==l)return sn(i.doc,tn(o,a),e),void 0;if(d=tn(o,d),m=tn(o,m),"double"==l){var t=wn(xr(o,e.line).text,e);Gt(e,d)?sn(i.doc,t.from,m):sn(i.doc,d,t.to)}else"triple"==l&&(Gt(e,d)?sn(i.doc,m,tn(o,Kt(e.line,0))):sn(i.doc,d,tn(o,Kt(e.line+1,0))))}}function n(e){var r=++b,u=bt(i,e,!0);if(u)if(Qt(u,h)){var a=e.clientY<y.top?-20:e.clientY>y.bottom?20:0;a&&setTimeout(ut(i,function(){b==r&&(s.scroller.scrollTop+=a,n(e))}),50)}else{i.state.focused||Bt(i),h=u,t(u);var f=v(s,o);(u.line>=f.to||u.line<f.from)&&setTimeout(ut(i,function(){b==r&&n(e)}),150)}}function r(e){b=1/0,zr(e),vt(i),Qr(document,"mousemove",w),Qr(document,"mouseup",E)}if(!Zr(this,e)){var i=this,s=i.display,o=i.doc,u=o.sel;if(u.shift=e.shiftKey,yt(s,e))return Ui||(s.scroller.draggable=!1,setTimeout(function(){s.scroller.draggable=!0},100)),void 0;if(!xt(i,e)){var a=bt(i,e);switch(window.focus(),Jr(e)){case 3:return os&&Ft.call(i,i,e),void 0;case 2:return Ui&&(i.state.lastMiddleDown=+(new Date)),a&&sn(i.doc,a),setTimeout(hi(vt,i),20),zr(e),void 0}if(!a)return $r(e)==s.scroller&&zr(e),void 0;i.state.focused||Bt(i);var f=+(new Date),l="single";if(is&&is.time>f-400&&Qt(is.pos,a))l="triple",zr(e),setTimeout(hi(vt,i),20),En(i,a.line);else if(rs&&rs.time>f-400&&Qt(rs.pos,a)){l="double",is={time:f,pos:a},zr(e);var c=wn(xr(o,a.line).text,a);sn(i.doc,c.from,c.to)}else rs={time:f,pos:a};var h=a;if(i.options.dragDrop&&zs&&!mt(i)&&!Qt(u.from,u.to)&&!Gt(a,u.from)&&!Gt(u.to,a)&&"single"==l){var p=ut(i,function(t){Ui&&(s.scroller.draggable=!1),i.state.draggingText=!1,Qr(document,"mouseup",p),Qr(s.scroller,"drop",p),Math.abs(e.clientX-t.clientX)+Math.abs(e.clientY-t.clientY)<10&&(zr(t),sn(i.doc,a),vt(i),ji&&!Ii&&setTimeout(function(){document.body.focus(),vt(i)},20))});return Ui&&(s.scroller.draggable=!0),i.state.draggingText=p,s.scroller.dragDrop&&s.scroller.dragDrop(),Kr(document,"mouseup",p),Kr(s.scroller,"drop",p),void 0}zr(e),"single"==l&&sn(i.doc,tn(o,a));var d=u.from,m=u.to,g=a,y=wi(s.wrapper),b=0,w=ut(i,function(e){ji||Jr(e)?n(e):r(e)}),E=ut(i,r);Kr(document,"mousemove",w),Kr(document,"mouseup",E)}}}function Et(e,t,n,r,i){try{var s=t.clientX,o=t.clientY}catch(t){return!1}if(s>=Math.floor(wi(e.display.gutters).right))return!1;r&&zr(t);var u=e.display,a=wi(u.lineDiv);if(o>a.bottom||!ti(e,n))return Xr(t);o-=a.top-u.viewOffset;for(var f=0;f<e.options.gutters.length;++f){var l=u.gutters.childNodes[f];if(l&&wi(l).right>=s){var c=Lr(e.doc,o),h=e.options.gutters[f];return i(e,n,e,c,h,t),Xr(t)}}}function St(e,t){return ti(e,"gutterContextMenu")?Et(e,t,"gutterContextMenu",!1,Gr):!1}function xt(e,t){return Et(e,t,"gutterClick",!0,Yr)}function Tt(e){var t=this;if(!(Zr(t,e)||yt(t.display,e)||t.options.onDragEvent&&t.options.onDragEvent(t,Ur(e)))){zr(e),Ri&&(ls=+(new Date));var n=bt(t,e,!0),r=e.dataTransfer.files;if(n&&!mt(t))if(r&&r.length&&window.FileReader&&window.File)for(var i=r.length,s=Array(i),o=0,u=function(e,r){var u=new FileReader;u.onload=function(){s[r]=u.result,++o==i&&(n=tn(t.doc,n),Ut(t.doc,{from:n,to:n,text:Vs(s.join("\n")),origin:"paste"},"around"))},u.readAsText(e)},a=0;i>a;++a)u(r[a],a);else{if(t.state.draggingText&&!Gt(n,t.doc.sel.from)&&!Gt(t.doc.sel.to,n))return t.state.draggingText(e),setTimeout(hi(vt,t),20),void 0;try{var s=e.dataTransfer.getData("Text");if(s){var f=t.doc.sel.from,l=t.doc.sel.to;un(t.doc,n,n),t.state.draggingText&&Jt(t.doc,"",f,l,"paste"),t.replaceSelection(s,null,"paste"),vt(t)}}catch(e){}}}}function Nt(e,t){if(Ri&&(!e.state.draggingText||+(new Date)-ls<100))return Vr(t),void 0;if(!Zr(e,t)&&!yt(e.display,t)){var n=e.getSelection();if(t.dataTransfer.setData("Text",n),t.dataTransfer.setDragImage&&!Vi){var r=mi("img",null,null,"position: fixed; left: 0; top: 0;");r.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",Xi&&(r.width=r.height=1,e.display.wrapper.appendChild(r),r._top=r.offsetTop),t.dataTransfer.setDragImage(r,0,0),Xi&&r.parentNode.removeChild(r)}}}function Ct(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,Bi||w(e,[],t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbarV.scrollTop!=t&&(e.display.scrollbarV.scrollTop=t),Bi&&w(e,[]),D(e,100))}function kt(e,t,n){(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,m(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbarH.scrollLeft!=t&&(e.display.scrollbarH.scrollLeft=t))}function Lt(e,t){var n=t.wheelDeltaX,r=t.wheelDeltaY;null==n&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(n=t.detail),null==r&&t.detail&&t.axis==t.VERTICAL_AXIS?r=t.detail:null==r&&(r=t.wheelDelta);var i=e.display,s=i.scroller;if(n&&s.scrollWidth>s.clientWidth||r&&s.scrollHeight>s.clientHeight){if(r&&Zi&&Ui)for(var o=t.target;o!=s;o=o.parentNode)if(o.lineObj){e.display.currentWheelTarget=o;break}if(n&&!Bi&&!Xi&&null!=hs)return r&&Ct(e,Math.max(0,Math.min(s.scrollTop+r*hs,s.scrollHeight-s.clientHeight))),kt(e,Math.max(0,Math.min(s.scrollLeft+n*hs,s.scrollWidth-s.clientWidth))),zr(t),i.wheelStartX=null,void 0;if(r&&null!=hs){var u=r*hs,a=e.doc.scrollTop,f=a+i.wrapper.clientHeight;0>u?a=Math.max(0,a+u-50):f=Math.min(e.doc.height,f+u+50),w(e,[],{top:a,bottom:f})}20>cs&&(null==i.wheelStartX?(i.wheelStartX=s.scrollLeft,i.wheelStartY=s.scrollTop,i.wheelDX=n,i.wheelDY=r,setTimeout(function(){if(null!=i.wheelStartX){var e=s.scrollLeft-i.wheelStartX,t=s.scrollTop-i.wheelStartY,n=t&&i.wheelDY&&t/i.wheelDY||e&&i.wheelDX&&e/i.wheelDX;i.wheelStartX=i.wheelStartY=null,n&&(hs=(hs*cs+n)/(cs+1),++cs)}},200)):(i.wheelDX+=n,i.wheelDY+=r))}}function At(e,t,n){if("string"==typeof t&&(t=Ns[t],!t))return!1;e.display.pollingFast&&pt(e)&&(e.display.pollingFast=!1);var r=e.doc,i=r.sel.shift,s=!1;try{mt(e)&&(e.state.suppressEdits=!0),n&&(r.sel.shift=!1),s=t(e)!=Is}finally{r.sel.shift=i,e.state.suppressEdits=!1}return s}function Ot(e){var t=e.state.keyMaps.slice(0);return e.options.extraKeys&&t.push(e.options.extraKeys),t.push(e.options.keyMap),t}function Mt(e,t){var n=Nn(e.options.keyMap),r=n.auto;clearTimeout(ps),r&&!kn(t)&&(ps=setTimeout(function(){Nn(e.options.keyMap)==n&&(e.options.keyMap=r.call?r.call(null,e):r,u(e))},50));var i=Ln(t,!0),s=!1;if(!i)return!1;var o=Ot(e);return s=t.shiftKey?Cn("Shift-"+i,o,function(t){return At(e,t,!0)})||Cn(i,o,function(t){return("string"==typeof t?/^go[A-Z]/.test(t):t.motion)?At(e,t):void 0}):Cn(i,o,function(t){return At(e,t)}),s&&(zr(t),_(e),Ii&&(t.oldKeyCode=t.keyCode,t.keyCode=0),Yr(e,"keyHandled",e,i,t)),s}function _t(e,t,n){var r=Cn("'"+n+"'",Ot(e),function(t){return At(e,t,!0)});return r&&(zr(t),_(e),Yr(e,"keyHandled",e,"'"+n+"'",t)),r}function Dt(e){var t=this;Zr(t,e)||t.options.onKeyEvent&&t.options.onKeyEvent(t,Ur(e))||16==e.keyCode&&(t.doc.sel.shift=!1)}function Pt(e){var t=this;if(t.state.focused||Bt(t),!(Zr(t,e)||t.options.onKeyEvent&&t.options.onKeyEvent(t,Ur(e)))){ji&&27==e.keyCode&&(e.returnValue=!1);var n=e.keyCode;t.doc.sel.shift=16==n||e.shiftKey;var r=Mt(t,e);Xi&&(vs=r?n:null,!r&&88==n&&!Js&&(Zi?e.metaKey:e.ctrlKey)&&t.replaceSelection(""))}}function Ht(e){var t=this;if(!(Zr(t,e)||t.options.onKeyEvent&&t.options.onKeyEvent(t,Ur(e)))){var n=e.keyCode,r=e.charCode;if(Xi&&n==vs)return vs=null,zr(e),void 0;if(!(Xi&&(!e.which||e.which<10)||$i)||!Mt(t,e)){var i=String.fromCharCode(null==r?n:r);_t(t,e,i)||(Ri&&!Ii&&(t.display.inputHasSelection=null),ht(t))}}}function Bt(e){"nocursor"!=e.options.readOnly&&(e.state.focused||(Gr(e,"focus",e),e.state.focused=!0,-1==e.display.wrapper.className.search(/\bCodeMirror-focused\b/)&&(e.display.wrapper.className+=" CodeMirror-focused"),e.curOp||(dt(e,!0),Ui&&setTimeout(hi(dt,e,!0),0))),ct(e),_(e))}function jt(e){e.state.focused&&(Gr(e,"blur",e),e.state.focused=!1,e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-focused","")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.doc.sel.shift=!1)},150)}function Ft(e,t){function n(){if(null!=i.input.selectionStart){var e=i.input.value="​"+(Qt(s.from,s.to)?"":i.input.value);i.prevInput="​",i.input.selectionStart=1,i.input.selectionEnd=e.length}}function r(){if(i.inputDiv.style.position="relative",i.input.style.cssText=f,Ii&&(i.scrollbarV.scrollTop=i.scroller.scrollTop=u),ct(e),null!=i.input.selectionStart){(!Ri||Ii)&&n(),clearTimeout(ds);var t=0,r=function(){"​"==i.prevInput&&0==i.input.selectionStart?ut(e,Ns.selectAll)(e):t++<10?ds=setTimeout(r,500):dt(e)};ds=setTimeout(r,200)}}if(!Zr(e,t,"contextmenu")){var i=e.display,s=e.doc.sel;if(!yt(i,t)&&!St(e,t)){var o=bt(e,t),u=i.scroller.scrollTop;if(o&&!Xi){var a=e.options.resetSelectionOnContextMenu;a&&(Qt(s.from,s.to)||Gt(o,s.from)||!Gt(o,s.to))&&ut(e,un)(e.doc,o,o);var f=i.input.style.cssText;if(i.inputDiv.style.position="absolute",i.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(t.clientY-5)+"px; left: "+(t.clientX-5)+"px; z-index: 1000; background: transparent; outline: none;"+"border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);",vt(e),dt(e,!0),Qt(s.from,s.to)&&(i.input.value=i.prevInput=" "),Ri&&!Ii&&n(),os){Vr(t);var l=function(){Qr(window,"mouseup",l),setTimeout(r,20)};Kr(window,"mouseup",l)}else setTimeout(r,50)}}}}function It(e,t,n){if(!Gt(t.from,n))return tn(e,n);var r=t.text.length-1-(t.to.line-t.from.line);if(n.line>t.to.line+r){var i=n.line-r,s=e.first+e.size-1;return i>s?Kt(s,xr(e,s).text.length):nn(n,xr(e,i).text.length)}if(n.line==t.to.line+r)return nn(n,oi(t.text).length+(1==t.text.length?t.from.ch:0)+xr(e,t.to.line).text.length-t.to.ch);var o=n.line-t.from.line;return nn(n,t.text[o].length+(o?0:t.from.ch))}function qt(e,t,n){if(n&&"object"==typeof n)return{anchor:It(e,t,n.anchor),head:It(e,t,n.head)};if("start"==n)return{anchor:t.from,head:t.from};var r=ms(t);if("around"==n)return{anchor:t.from,head:r};if("end"==n)return{anchor:r,head:r};var i=function(e){if(Gt(e,t.from))return e;if(!Gt(t.to,e))return r;var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=r.ch-t.to.ch),Kt(n,i)};return{anchor:i(e.sel.anchor),head:i(e.sel.head)}}function Rt(e,t,n){var r={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return n&&(r.update=function(t,n,r,i){t&&(this.from=tn(e,t)),n&&(this.to=tn(e,n)),r&&(this.text=r),void 0!==i&&(this.origin=i)}),Gr(e,"beforeChange",e,r),e.cm&&Gr(e.cm,"beforeChange",e.cm,r),r.canceled?null:{from:r.from,to:r.to,text:r.text,origin:r.origin}}function Ut(e,t,n,r){if(e.cm){if(!e.cm.curOp)return ut(e.cm,Ut)(e,t,n,r);if(e.cm.state.suppressEdits)return}if(!(ti(e,"beforeChange")||e.cm&&ti(e.cm,"beforeChange"))||(t=Rt(e,t,!0))){var i=us&&!r&&Un(e,t.from,t.to);if(i){for(var s=i.length-1;s>=1;--s)zt(e,{from:i[s].from,to:i[s].to,text:[""]});i.length&&zt(e,{from:i[0].from,to:i[0].to,text:t.text},n)}else zt(e,t,n)}}function zt(e,t,n){if(1!=t.text.length||""!=t.text[0]||!Qt(t.from,t.to)){var r=qt(e,t,n);Pr(e,t,r,e.cm?e.cm.curOp.id:0/0),Vt(e,t,r,In(e,t));var i=[];Er(e,function(e,n){n||-1!=ai(i,e.history)||(qr(e.history,t),i.push(e.history)),Vt(e,t,null,In(e,t))})}}function Wt(e,t){if(!e.cm||!e.cm.state.suppressEdits){var n=e.history,r=("undo"==t?n.done:n.undone).pop();if(r){var i={changes:[],anchorBefore:r.anchorAfter,headBefore:r.headAfter,anchorAfter:r.anchorBefore,headAfter:r.headBefore,generation:n.generation};("undo"==t?n.undone:n.done).push(i),n.generation=r.generation||++n.maxGeneration;for(var s=ti(e,"beforeChange")||e.cm&&ti(e.cm,"beforeChange"),o=r.changes.length-1;o>=0;--o){var u=r.changes[o];if(u.origin=t,s&&!Rt(e,u,!1))return("undo"==t?n.done:n.undone).length=0,void 0;i.changes.push(Dr(e,u));var a=o?qt(e,u,null):{anchor:r.anchorBefore,head:r.headBefore};Vt(e,u,a,Rn(e,u));var f=[];Er(e,function(e,t){t||-1!=ai(f,e.history)||(qr(e.history,u),f.push(e.history)),Vt(e,u,null,Rn(e,u))})}}}}function Xt(e,t){function n(e){return Kt(e.line+t,e.ch)}e.first+=t,e.cm&&lt(e.cm,e.first,e.first,t),e.sel.head=n(e.sel.head),e.sel.anchor=n(e.sel.anchor),e.sel.from=n(e.sel.from),e.sel.to=n(e.sel.to)}function Vt(e,t,n,r){if(e.cm&&!e.cm.curOp)return ut(e.cm,Vt)(e,t,n,r);if(t.to.line<e.first)return Xt(e,t.text.length-1-(t.to.line-t.from.line)),void 0;if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);Xt(e,i),t={from:Kt(e.first,0),to:Kt(t.to.line+i,t.to.ch),text:[oi(t.text)],origin:t.origin}}var s=e.lastLine();t.to.line>s&&(t={from:t.from,to:Kt(s,xr(e,s).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Tr(e,t.from,t.to),n||(n=qt(e,t,null)),e.cm?$t(e.cm,t,r,n):yr(e,t,r,n)}}function $t(e,t,n,r){var i=e.doc,o=e.display,u=t.from,a=t.to,f=!1,l=u.line;e.options.lineWrapping||(l=kr(Qn(i,xr(i,u.line))),i.iter(l,a.line+1,function(e){return e==o.maxLine?(f=!0,!0):void 0})),Gt(i.sel.head,t.from)||Gt(t.to,i.sel.head)||(e.curOp.cursorActivity=!0),yr(i,t,n,r,s(e)),e.options.lineWrapping||(i.iter(l,u.line+t.text.length,function(e){var t=c(i,e);t>o.maxLineLength&&(o.maxLine=e,o.maxLineLength=t,o.maxLineChanged=!0,f=!1)}),f&&(e.curOp.updateMaxLine=!0)),i.frontier=Math.min(i.frontier,u.line),D(e,400);var h=t.text.length-(a.line-u.line)-1;if(lt(e,u.line,a.line+1,h),ti(e,"change")){var p={from:u,to:a,text:t.text,removed:t.removed,origin:t.origin};if(e.curOp.textChanged){for(var d=e.curOp.textChanged;d.next;d=d.next);d.next=p}else e.curOp.textChanged=p}}function Jt(e,t,n,r,i){if(r||(r=n),Gt(r,n)){var s=r;r=n,n=s}"string"==typeof t&&(t=Vs(t)),Ut(e,{from:n,to:r,text:t,origin:i},null)}function Kt(e,t){return this instanceof Kt?(this.line=e,this.ch=t,void 0):new Kt(e,t)}function Qt(e,t){return e.line==t.line&&e.ch==t.ch}function Gt(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function Yt(e,t){return e.line-t.line||e.ch-t.ch}function Zt(e){return Kt(e.line,e.ch)}function en(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function tn(e,t){if(t.line<e.first)return Kt(e.first,0);var n=e.first+e.size-1;return t.line>n?Kt(n,xr(e,n).text.length):nn(t,xr(e,t.line).text.length)}function nn(e,t){var n=e.ch;return null==n||n>t?Kt(e.line,t):0>n?Kt(e.line,0):e}function rn(e,t){return t>=e.first&&t<e.first+e.size}function sn(e,t,n,r){if(e.sel.shift||e.sel.extend){var i=e.sel.anchor;if(n){var s=Gt(t,i);s!=Gt(n,i)?(i=t,t=n):s!=Gt(t,n)&&(t=n)}un(e,i,t,r)}else un(e,t,n||t,r);e.cm&&(e.cm.curOp.userSelChange=!0)}function on(e,t,n){var r={anchor:t,head:n};return Gr(e,"beforeSelectionChange",e,r),e.cm&&Gr(e.cm,"beforeSelectionChange",e.cm,r),r.anchor=tn(e,r.anchor),r.head=tn(e,r.head),r}function un(e,t,n,r,i){if(!i&&ti(e,"beforeSelectionChange")||e.cm&&ti(e.cm,"beforeSelectionChange")){var s=on(e,t,n);n=s.head,t=s.anchor}var o=e.sel;if(o.goalColumn=null,null==r&&(r=Gt(n,o.head)?-1:1),(i||!Qt(t,o.anchor))&&(t=fn(e,t,r,"push"!=i)),(i||!Qt(n,o.head))&&(n=fn(e,n,r,"push"!=i)),!Qt(o.anchor,t)||!Qt(o.head,n)){o.anchor=t,o.head=n;var u=Gt(n,t);o.from=u?n:t,o.to=u?t:n,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=e.cm.curOp.cursorActivity=!0),Yr(e,"cursorActivity",e)}}function an(e){un(e.doc,e.doc.sel.from,e.doc.sel.to,null,"push")}function fn(e,t,n,r){var i=!1,s=t,o=n||1;e.cantEdit=!1;e:for(;;){var u=xr(e,s.line);if(u.markedSpans)for(var a=0;a<u.markedSpans.length;++a){var f=u.markedSpans[a],l=f.marker;if((null==f.from||(l.inclusiveLeft?f.from<=s.ch:f.from<s.ch))&&(null==f.to||(l.inclusiveRight?f.to>=s.ch:f.to>s.ch))){if(r&&(Gr(l,"beforeCursorEnter"),l.explicitlyCleared)){if(u.markedSpans){--a;continue}break}if(!l.atomic)continue;var c=l.find()[0>o?"from":"to"];if(Qt(c,s)&&(c.ch+=o,c.ch<0?c=c.line>e.first?tn(e,Kt(c.line-1)):null:c.ch>u.text.length&&(c=c.line<e.first+e.size-1?Kt(c.line+1,0):null),!c)){if(i)return r?(e.cantEdit=!0,Kt(e.first,0)):fn(e,t,n,!0);i=!0,c=t,o=-o}s=c;continue e}}return s}}function ln(e){var t=cn(e,e.doc.sel.head,null,e.options.cursorScrollMargin);if(e.state.focused){var n=e.display,r=wi(n.sizer),i=null;if(t.top+r.top<0?i=!0:t.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1),null!=i&&!Qi){var s=mi("div","​",null,"position: absolute; top: "+(t.top-n.viewOffset)+"px; height: "+(t.bottom-t.top+Fs)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(s),s.scrollIntoView(i),e.display.lineSpace.removeChild(s)}}}function cn(e,t,n,r){for(null==r&&(r=0);;){var i=!1,s=Z(e,t),o=n&&n!=t?Z(e,n):s,u=pn(e,Math.min(s.left,o.left),Math.min(s.top,o.top)-r,Math.max(s.left,o.left),Math.max(s.bottom,o.bottom)+r),a=e.doc.scrollTop,f=e.doc.scrollLeft;if(null!=u.scrollTop&&(Ct(e,u.scrollTop),Math.abs(e.doc.scrollTop-a)>1&&(i=!0)),null!=u.scrollLeft&&(kt(e,u.scrollLeft),Math.abs(e.doc.scrollLeft-f)>1&&(i=!0)),!i)return s}}function hn(e,t,n,r,i){var s=pn(e,t,n,r,i);null!=s.scrollTop&&Ct(e,s.scrollTop),null!=s.scrollLeft&&kt(e,s.scrollLeft)}function pn(e,t,n,r,i){var s=e.display,o=rt(e.display);0>n&&(n=0);var u=s.scroller.clientHeight-Fs,a=s.scroller.scrollTop,f={},l=e.doc.height+F(s),c=o>n,h=i>l-o;if(a>n)f.scrollTop=c?0:n;else if(i>a+u){var p=Math.min(n,(h?l:i)-u);p!=a&&(f.scrollTop=p)}var d=s.scroller.clientWidth-Fs,v=s.scroller.scrollLeft;t+=s.gutters.offsetWidth,r+=s.gutters.offsetWidth;var m=s.gutters.offsetWidth,g=m+10>t;return v+m>t||g?(g&&(t=0),f.scrollLeft=Math.max(0,t-10-m)):r>d+v-3&&(f.scrollLeft=r+10-d),f}function dn(e,t,n){e.curOp.updateScrollPos={scrollLeft:null==t?e.doc.scrollLeft:t,scrollTop:null==n?e.doc.scrollTop:n}}function vn(e,t,n){var r=e.curOp.updateScrollPos||(e.curOp.updateScrollPos={scrollLeft:e.doc.scrollLeft,scrollTop:e.doc.scrollTop}),i=e.display.scroller;r.scrollTop=Math.max(0,Math.min(i.scrollHeight-i.clientHeight,r.scrollTop+n)),r.scrollLeft=Math.max(0,Math.min(i.scrollWidth-i.clientWidth,r.scrollLeft+t))}function mn(e,t,n,r){var i,s=e.doc;null==n&&(n="add"),"smart"==n&&(e.doc.mode.indent?i=B(e,t):n="prev");var o=e.options.tabSize,u=xr(s,t),a=ii(u.text,null,o);u.stateAfter&&(u.stateAfter=null);var f,l=u.text.match(/^\s*/)[0];if(r||/\S/.test(u.text)){if("smart"==n&&(f=e.doc.mode.indent(i,u.text.slice(l.length),u.text),f==Is)){if(!r)return;n="prev"}}else f=0,n="not";"prev"==n?f=t>s.first?ii(xr(s,t-1).text,null,o):0:"add"==n?f=a+e.options.indentUnit:"subtract"==n?f=a-e.options.indentUnit:"number"==typeof n&&(f=a+n),f=Math.max(0,f);var c="",h=0;if(e.options.indentWithTabs)for(var p=Math.floor(f/o);p;--p)h+=o,c+="  ";f>h&&(c+=si(f-h)),c!=l?Jt(e.doc,c,Kt(t,0),Kt(t,l.length),"+input"):s.sel.head.line==t&&s.sel.head.ch<l.length&&un(s,Kt(t,l.length),Kt(t,l.length),1),u.stateAfter=null}function gn(e,t,n){var r=t,i=t,s=e.doc;return"number"==typeof t?i=xr(s,en(s,t)):r=kr(t),null==r?null:n(i,r)?(lt(e,r,r+1),i):null}function yn(e,t,n,r,i){function s(){var t=u+n;return t<e.first||t>=e.first+e.size?c=!1:(u=t,l=xr(e,t))}function o(e){var t=(i?Pi:Hi)(l,a,n,!0);if(null==t){if(e||!s())return c=!1;a=i?(0>n?Li:ki)(l):0>n?l.text.length:0}else a=t;return!0}var u=t.line,a=t.ch,f=n,l=xr(e,u),c=!0;if("char"==r)o();else if("column"==r)o(!0);else if("word"==r||"group"==r)for(var h=null,p="group"==r,d=!0;!(0>n)||o(!d);d=!1){var v=l.text.charAt(a)||"\n",m=pi(v)?"w":p?/\s/.test(v)?null:"p":null;if(h&&h!=m){0>n&&(n=1,o());break}if(m&&(h=m),n>0&&!o(!d))break}var g=fn(e,Kt(u,a),f,!0);return c||(g.hitSide=!0),g}function bn(e,t,n,r){var i,s=e.doc,o=t.left;if("page"==r){var u=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);i=t.top+n*(u-(0>n?1.5:.5)*rt(e.display))}else"line"==r&&(i=n>0?t.bottom+3:t.top-3);for(;;){var a=tt(e,o,i);if(!a.outside)break;if(0>n?0>=i:i>=s.height){a.hitSide=!0;break}i+=5*n}return a}function wn(e,t){var n=t.ch,r=t.ch;if(e){(t.xRel<0||r==e.length)&&n?--n:++r;for(var i=e.charAt(n),s=pi(i)?pi:/\s/.test(i)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!pi(e)};n>0&&s(e.charAt(n-1));)--n;for(;r<e.length&&s(e.charAt(r));)++r}return{from:Kt(t.line,n),to:Kt(t.line,r)}}function En(e,t){sn(e.doc,Kt(t,0),tn(e.doc,Kt(t+1,0)))}function Sn(t,n,r,i){e.defaults[t]=n,r&&(gs[t]=i?function(e,t,n){n!=bs&&r(e,t,n)}:r)}function xn(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var n={};for(var r in t){var i=t[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n}function Tn(e,t,n){return e.startState?e.startState(t,n):!0}function Nn(e){return"string"==typeof e?Cs[e]:e}function Cn(e,t,n){function r(t){t=Nn(t);var i=t[e];if(i===!1)return"stop";if(null!=i&&n(i))return!0;if(t.nofallthrough)return"stop";var s=t.fallthrough;if(null==s)return!1;if("[object Array]"!=Object.prototype.toString.call(s))return r(s);for(var o=0,u=s.length;u>o;++o){var a=r(s[o]);if(a)return a}return!1}for(var i=0;i<t.length;++i){var s=r(t[i]);if(s)return"stop"!=s}}function kn(e){var t=Ks[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t}function Ln(e,t){if(Xi&&34==e.keyCode&&e["char"])return!1;var n=Ks[e.keyCode];return null==n||e.altGraphKey?!1:(e.altKey&&(n="Alt-"+n),(ss?e.metaKey:e.ctrlKey)&&(n="Ctrl-"+n),(ss?e.ctrlKey:e.metaKey)&&(n="Cmd-"+n),!t&&e.shiftKey&&(n="Shift-"+n),n)}function An(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0}function On(e,t){this.lines=[],this.type=t,this.doc=e}function Mn(e,t,n,r,i){if(r&&r.shared)return Dn(e,t,n,r,i);if(e.cm&&!e.cm.curOp)return ut(e.cm,Mn)(e,t,n,r,i);var s=new On(e,i);if(r&&li(r,s),Gt(n,t)||Qt(t,n)&&s.clearWhenEmpty!==!1)return s;if(s.replacedWith&&(s.collapsed=!0,s.replacedWith=mi("span",[s.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||(s.replacedWith.ignoreEvents=!0)),s.collapsed){if(Kn(e,t.line,t,n,s)||t.line!=n.line&&Kn(e,n.line,t,n,s))throw new Error("Inserting collapsed marker partially overlapping an existing one");as=!0}s.addToHistory&&Pr(e,{from:t,to:n,origin:"markText"},{head:e.sel.head,anchor:e.sel.anchor},0/0);var o,u=t.line,a=e.cm;return e.iter(u,n.line+1,function(r){a&&s.collapsed&&!a.options.lineWrapping&&Qn(e,r)==a.display.maxLine&&(o=!0);var i={from:null,to:null,marker:s};u==t.line&&(i.from=t.ch),u==n.line&&(i.to=n.ch),s.collapsed&&u!=t.line&&Cr(r,0),Bn(r,i),++u}),s.collapsed&&e.iter(t.line,n.line+1,function(t){Gn(e,t)&&Cr(t,0)}),s.clearOnEnter&&Kr(s,"beforeCursorEnter",function(){s.clear()}),s.readOnly&&(us=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),s.collapsed&&(s.id=++ks,s.atomic=!0),a&&(o&&(a.curOp.updateMaxLine=!0),(s.className||s.title||s.startStyle||s.endStyle||s.collapsed)&&lt(a,t.line,n.line+1),s.atomic&&an(a)),s}function _n(e,t){this.markers=e,this.primary=t;for(var n=0,r=this;n<e.length;++n)e[n].parent=this,Kr(e[n],"clear",function(){r.clear()})}function Dn(e,t,n,r,i){r=li(r),r.shared=!1;var s=[Mn(e,t,n,r,i)],o=s[0],u=r.replacedWith;return Er(e,function(e){u&&(r.replacedWith=u.cloneNode(!0)),s.push(Mn(e,tn(e,t),tn(e,n),r,i));for(var a=0;a<e.linked.length;++a)if(e.linked[a].isParent)return;o=oi(s)}),new _n(s,o)}function Pn(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function Hn(e,t){for(var n,r=0;r<e.length;++r)e[r]!=t&&(n||(n=[])).push(e[r]);return n}function Bn(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function jn(e,t,n){if(e)for(var r,i=0;i<e.length;++i){var s=e[i],o=s.marker,u=null==s.from||(o.inclusiveLeft?s.from<=t:s.from<t);if(u||s.from==t&&"bookmark"==o.type&&(!n||!s.marker.insertLeft)){var a=null==s.to||(o.inclusiveRight?s.to>=t:s.to>t);(r||(r=[])).push({from:s.from,to:a?null:s.to,marker:o})}}return r}function Fn(e,t,n){if(e)for(var r,i=0;i<e.length;++i){var s=e[i],o=s.marker,u=null==s.to||(o.inclusiveRight?s.to>=t:s.to>t);if(u||s.from==t&&"bookmark"==o.type&&(!n||s.marker.insertLeft)){var a=null==s.from||(o.inclusiveLeft?s.from<=t:s.from<t);(r||(r=[])).push({from:a?null:s.from-t,to:null==s.to?null:s.to-t,marker:o})}}return r}function In(e,t){var n=rn(e,t.from.line)&&xr(e,t.from.line).markedSpans,r=rn(e,t.to.line)&&xr(e,t.to.line).markedSpans;if(!n&&!r)return null;var i=t.from.ch,s=t.to.ch,o=Qt(t.from,t.to),u=jn(n,i,o),a=Fn(r,s,o),f=1==t.text.length,l=oi(t.text).length+(f?i:0);if(u)for(var c=0;c<u.length;++c){var h=u[c];if(null==h.to){var p=Pn(a,h.marker);p?f&&(h.to=null==p.to?null:p.to+l):h.to=i}}if(a)for(var c=0;c<a.length;++c){var h=a[c];if(null!=h.to&&(h.to+=l),null==h.from){var p=Pn(u,h.marker);p||(h.from=l,f&&(u||(u=[])).push(h))}else h.from+=l,f&&(u||(u=[])).push(h)}u&&(u=qn(u)),a&&a!=u&&(a=qn(a));var d=[u];if(!f){var v,m=t.text.length-2;if(m>0&&u)for(var c=0;c<u.length;++c)null==u[c].to&&(v||(v=[])).push({from:null,to:null,marker:u[c].marker});for(var c=0;m>c;++c)d.push(v);d.push(a)}return d}function qn(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&n.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function Rn(e,t){var n=Br(e,t),r=In(e,t);if(!n)return r;if(!r)return n;for(var i=0;i<n.length;++i){var s=n[i],o=r[i];if(s&&o)e:for(var u=0;u<o.length;++u){for(var a=o[u],f=0;f<s.length;++f)if(s[f].marker==a.marker)continue e;s.push(a)}else o&&(n[i]=o)}return n}function Un(e,t,n){var r=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||r&&-1!=ai(r,n)||(r||(r=[])).push(n)}}),!r)return null;for(var i=[{from:t,to:n}],s=0;s<r.length;++s)for(var o=r[s],u=o.find(),a=0;a<i.length;++a){var f=i[a];if(!Gt(f.to,u.from)&&!Gt(u.to,f.from)){var l=[a,1];(Gt(f.from,u.from)||!o.inclusiveLeft&&Qt(f.from,u.from))&&l.push({from:f.from,to:u.from}),(Gt(u.to,f.to)||!o.inclusiveRight&&Qt(f.to,u.to))&&l.push({from:u.to,to:f.to}),i.splice.apply(i,l),a+=l.length-1}}return i}function zn(e){return e.inclusiveLeft?-1:0}function Wn(e){return e.inclusiveRight?1:0}function Xn(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var r=e.find(),i=t.find(),s=Yt(r.from,i.from)||zn(e)-zn(t);if(s)return-s;var o=Yt(r.to,i.to)||Wn(e)-Wn(t);return o?o:t.id-e.id}function Vn(e,t){var n,r=as&&e.markedSpans;if(r)for(var i,s=0;s<r.length;++s)i=r[s],i.marker.collapsed&&null==(t?i.from:i.to)&&(!n||Xn(n,i.marker)<0)&&(n=i.marker);return n}function $n(e){return Vn(e,!0)}function Jn(e){return Vn(e,!1)}function Kn(e,t,n,r,i){var s=xr(e,t),o=as&&s.markedSpans;if(o)for(var u=0;u<o.length;++u){var a=o[u];if(a.marker.collapsed){var f=a.marker.find(!0),l=Yt(f.from,n)||zn(a.marker)-zn(i),c=Yt(f.to,r)||Wn(a.marker)-Wn(i);if(!(l>=0&&0>=c||0>=l&&c>=0)&&(0>=l&&(Yt(f.to,n)||Wn(a.marker)-zn(i))>0||l>=0&&(Yt(f.from,r)||zn(a.marker)-Wn(i))<0))return!0}}}function Qn(e,t){for(var n;n=$n(t);)t=xr(e,n.find().from.line);return t}function Gn(e,t){var n=as&&t.markedSpans;if(n)for(var r,i=0;i<n.length;++i)if(r=n[i],r.marker.collapsed){if(null==r.from)return!0;if(!r.marker.replacedWith&&0==r.from&&r.marker.inclusiveLeft&&Yn(e,t,r))return!0}}function Yn(e,t,n){if(null==n.to){var r=n.marker.find().to,i=xr(e,r.line);return Yn(e,i,Pn(i.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var s,o=0;o<t.markedSpans.length;++o)if(s=t.markedSpans[o],s.marker.collapsed&&!s.marker.replacedWith&&s.from==n.to&&(null==s.to||s.to!=n.from)&&(s.marker.inclusiveLeft||n.marker.inclusiveRight)&&Yn(e,t,s))return!0}function Zn(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function er(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function tr(e){return function(){var t=!this.cm.curOp;t&&st(this.cm);try{var n=e.apply(this,arguments)}finally{t&&ot(this.cm)}return n}}function nr(e){return null!=e.height?e.height:(e.node.parentNode&&1==e.node.parentNode.nodeType||yi(e.cm.display.measure,mi("div",[e.node],null,"position: relative")),e.height=e.node.offsetHeight)}function rr(e,t,n,r){var i=new Ls(e,n,r);return i.noHScroll&&(e.display.alignWidgets=!0),gn(e,t,function(t){var n=t.widgets||(t.widgets=[]);if(null==i.insertAt?n.push(i):n.splice(Math.min(n.length-1,Math.max(0,i.insertAt)),0,i),i.line=t,!Gn(e.doc,t)||i.showIfHidden){var r=Ar(e,t)<e.doc.scrollTop;Cr(t,t.height+nr(i)),r&&vn(e,0,i.height)}return!0}),i}function ir(e,t,n,r){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),Zn(e),er(e,n);var i=r?r(e):1;i!=e.height&&Cr(e,i)}function sr(e){e.parent=null,Zn(e)}function or(t,n,r,i,s,o){var u=r.flattenSpans;null==u&&(u=t.options.flattenSpans);var a,f=0,l=null,c=new An(n,t.options.tabSize);for(""==n&&r.blankLine&&r.blankLine(i);!c.eol();){if(c.pos>t.options.maxHighlightLength?(u=!1,o&&fr(t,n,i,c.pos),c.pos=n.length,a=null):a=r.token(c,i),t.options.addModeClass){var h=e.innerMode(r,i).mode.name;h&&(a="m-"+(a?h+" "+a:h))}u&&l==a||(f<c.start&&s(c.start,l),f=c.start,l=a),c.start=c.pos}for(;f<c.pos;){var p=Math.min(c.pos,f+5e4);s(p,l),f=p}}function ur(e,t,n,r){var i=[e.state.modeGen];or(e,t.text,e.doc.mode,n,function(e,t){i.push(e,t)},r);for(var s=0;s<e.state.overlays.length;++s){var o=e.state.overlays[s],u=1,a=0;or(e,t.text,o.mode,!0,function(e,t){for(var n=u;e>a;){var r=i[u];r>e&&i.splice(u,1,e,i[u+1],r),u+=2,a=Math.min(e,r)}if(t)if(o.opaque)i.splice(n,u-n,e,t),u=n+2;else for(;u>n;n+=2){var s=i[n+1];i[n+1]=s?s+" "+t:t}})}return i}function ar(e,t){return t.styles&&t.styles[0]==e.state.modeGen||(t.styles=ur(e,t,t.stateAfter=B(e,kr(t)))),t.styles}function fr(e,t,n,r){var i=e.doc.mode,s=new An(t,e.options.tabSize);for(s.start=s.pos=r||0,""==t&&i.blankLine&&i.blankLine(n);!s.eol()&&s.pos<=e.options.maxHighlightLength;)i.token(s,n),s.start=s.pos}function lr(e,t){if(!e)return null;for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var r=n[1]?"bgClass":"textClass";null==t[r]?t[r]=n[2]:(new RegExp("(?:^|s)"+n[2]+"(?:$|s)")).test(t[r])||(t[r]+=" "+n[2])}if(/^\s*$/.test(e))return null;var i=t.cm.options.addModeClass?Ms:Os;return i[e]||(i[e]=e.replace(/\S+/g,"cm-$&"))}function cr(e,t,n,r){for(var i,s=t,o=!0;i=$n(s);)s=xr(e.doc,i.find().from.line);var u={pre:mi("pre"),col:0,pos:0,measure:null,measuredSomething:!1,cm:e,copyWidgets:r};do{s.text&&(o=!1),u.measure=s==t&&n,u.pos=0,u.addToken=u.measure?dr:pr,(Ri||Ui)&&e.getOption("lineWrapping")&&(u.addToken=vr(u.addToken));var a=gr(s,u,ar(e,s));n&&s==t&&!u.measuredSomething&&(n[0]=u.pre.appendChild(xi(e.display.measure)),u.measuredSomething=!0),a&&(s=xr(e.doc,a.to.line))}while(a);!n||u.measuredSomething||n[0]||(n[0]=u.pre.appendChild(o?mi("span"," "):xi(e.display.measure))),u.pre.firstChild||Gn(e.doc,t)||u.pre.appendChild(document.createTextNode(" "));var f;if(n&&Ri&&(f=Or(s))){var l=f.length-1;f[l].from==f[l].to&&--l;var c=f[l],h=f[l-1];if(c.from+1==c.to&&h&&c.level<h.level){var p=n[u.pos-1];p&&p.parentNode.insertBefore(p.measureRight=xi(e.display.measure),p.nextSibling)}}var d=u.textClass?u.textClass+" "+(t.textClass||""):t.textClass;return d&&(u.pre.className=d),Gr(e,"renderLine",e,t,u.pre),u}function hr(e){var t=mi("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t}function pr(e,t,n,r,i,s){if(t){var o=e.cm.options.specialChars;if(o.test(t))for(var u=document.createDocumentFragment(),a=0;;){o.lastIndex=a;var f=o.exec(t),l=f?f.index-a:t.length-a;if(l&&(u.appendChild(document.createTextNode(t.slice(a,a+l))),e.col+=l),!f)break;if(a+=l+1," "==f[0]){var c=e.cm.options.tabSize,h=c-e.col%c;u.appendChild(mi("span",si(h),"cm-tab")),e.col+=h}else{var p=e.cm.options.specialCharPlaceholder(f[0]);u.appendChild(p),e.col+=1}}else{e.col+=t.length;var u=document.createTextNode(t)}if(n||r||i||e.measure){var d=n||"";r&&(d+=r),i&&(d+=i);var p=mi("span",[u],d);return s&&(p.title=s),e.pre.appendChild(p)}e.pre.appendChild(u)}}function dr(e,t,n,r,i){for(var s=e.cm.options.lineWrapping,o=0;o<t.length;++o){for(var u=0==o,a=o+1;a<t.length&&vi(t.charAt(a));)++a;var f=t.slice(o,a);o=a-1,o&&s&&Ei(t,o)&&e.pre.appendChild(mi("wbr"));var l=e.measure[e.pos],c=e.measure[e.pos]=pr(e,f,n,u&&r,o==t.length-1&&i);l&&(c.leftSide=l.leftSide||l),ji&&s&&" "==f&&o&&!/\s/.test(t.charAt(o-1))&&o<t.length-1&&!/\s/.test(t.charAt(o+1))&&(c.style.whiteSpace="normal"),e.pos+=f.length}t.length&&(e.measuredSomething=!0)}function vr(e){function t(e){for(var t=" ",n=0;n<e.length-2;++n)t+=n%2?" ":" ";return t+=" "}return function(n,r,i,s,o,u){return e(n,r.replace(/ {3,}/g,t),i,s,o,u)}}function mr(e,t,n,r){var i=!r&&n.replacedWith;if(i&&(e.copyWidgets&&(i=i.cloneNode(!0)),e.pre.appendChild(i),e.measure)){if(t)e.measure[e.pos]=i;else{var s=xi(e.cm.display.measure);if("bookmark"!=n.type||n.insertLeft){if(e.measure[e.pos])return;e.measure[e.pos]=e.pre.insertBefore(s,i)}else e.measure[e.pos]=e.pre.appendChild(s)}e.measuredSomething=!0}e.pos+=t}function gr(e,t,n){var r=e.markedSpans,i=e.text,s=0;if(r)for(var o,u,a,f,l,c,h=i.length,p=0,d=1,v="",m=0;;){if(m==p){u=a=f=l="",c=null,m=1/0;for(var g=[],y=0;y<r.length;++y){var b=r[y],w=b.marker;b.from<=p&&(null==b.to||b.to>p)?(null!=b.to&&m>b.to&&(m=b.to,a=""),w.className&&(u+=" "+w.className),w.startStyle&&b.from==p&&(f+=" "+w.startStyle),w.endStyle&&b.to==m&&(a+=" "+w.endStyle),w.title&&!l&&(l=w.title),w.collapsed&&(!c||Xn(c.marker,w)<0)&&(c=b)):b.from>p&&m>b.from&&(m=b.from),"bookmark"==w.type&&b.from==p&&w.replacedWith&&g.push(w)}if(c&&(c.from||0)==p&&(mr(t,(null==c.to?h:c.to)-p,c.marker,null==c.from),null==c.to))return c.marker.find();if(!c&&g.length)for(var y=0;y<g.length;++y)mr(t,0,g[y])}if(p>=h)break;for(var E=Math.min(h,m);;){if(v){var S=p+v.length;if(!c){var x=S>E?v.slice(0,E-p):v;t.addToken(t,x,o?o+u:u,f,p+x.length==m?a:"",l)}if(S>=E){v=v.slice(E-p),p=E;break}p=S,f=""}v=i.slice(s,s=n[d++]),o=lr(n[d++],t)}}else for(var d=1;d<n.length;d+=2)t.addToken(t,i.slice(s,s=n[d]),lr(n[d+1],t))}function yr(e,t,n,r,i){function s(e){return n?n[e]:null}function o(e,n,r){ir(e,n,r,i),Yr(e,"change",e,t)}var u=t.from,a=t.to,f=t.text,l=xr(e,u.line),c=xr(e,a.line),h=oi(f),p=s(f.length-1),d=a.line-u.line;if(0!=u.ch||0!=a.ch||""!=h||e.cm&&!e.cm.options.wholeLineUpdateBefore)if(l==c)if(1==f.length)o(l,l.text.slice(0,u.ch)+h+l.text.slice(a.ch),p);else{for(var v=[],m=1,g=f.length-1;g>m;++m)v.push(new As(f[m],s(m),i));v.push(new As(h+l.text.slice(a.ch),p,i)),o(l,l.text.slice(0,u.ch)+f[0],s(0)),e.insert(u.line+1,v)}else if(1==f.length)o(l,l.text.slice(0,u.ch)+f[0]+c.text.slice(a.ch),s(0)),e.remove(u.line+1,d);else{o(l,l.text.slice(0,u.ch)+f[0],s(0)),o(c,h+c.text.slice(a.ch),p);for(var m=1,g=f.length-1,v=[];g>m;++m)v.push(new As(f[m],s(m),i));d>1&&e.remove(u.line+1,d-1),e.insert(u.line+1,v)}else{for(var m=0,g=f.length-1,v=[];g>m;++m)v.push(new As(f[m],s(m),i));o(c,c.text,p),d&&e.remove(u.line,d),v.length&&e.insert(u.line,v)}Yr(e,"change",e,t),un(e,r.anchor,r.head,null,!0)}function br(e){this.lines=e,this.parent=null;for(var t=0,n=e.length,r=0;n>t;++t)e[t].parent=this,r+=e[t].height;this.height=r}function wr(e){this.children=e;for(var t=0,n=0,r=0,i=e.length;i>r;++r){var s=e[r];t+=s.chunkSize(),n+=s.height,s.parent=this}this.size=t,this.height=n,this.parent=null}function Er(e,t,n){function r(e,i,s){if(e.linked)for(var o=0;o<e.linked.length;++o){var u=e.linked[o];if(u.doc!=i){var a=s&&u.sharedHist;(!n||a)&&(t(u.doc,a),r(u.doc,e,a))}}}r(e,null,!0)}function Sr(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,o(e),n(e),e.options.lineWrapping||h(e),e.options.mode=t.modeOption,lt(e)}function xr(e,t){for(t-=e.first;!e.lines;)for(var n=0;;++n){var r=e.children[n],i=r.chunkSize();if(i>t){e=r;break}t-=i}return e.lines[t]}function Tr(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,function(e){var s=e.text;i==n.line&&(s=s.slice(0,n.ch)),i==t.line&&(s=s.slice(t.ch)),r.push(s),++i}),r}function Nr(e,t,n){var r=[];return e.iter(t,n,function(e){r.push(e.text)}),r}function Cr(e,t){for(var n=t-e.height,r=e;r;r=r.parent)r.height+=n}function kr(e){if(null==e.parent)return null;for(var t=e.parent,n=ai(t.lines,e),r=t.parent;r;t=r,r=r.parent)for(var i=0;r.children[i]!=t;++i)n+=r.children[i].chunkSize();return n+t.first}function Lr(e,t){var n=e.first;e:do{for(var r=0,i=e.children.length;i>r;++r){var s=e.children[r],o=s.height;if(o>t){e=s;continue e}t-=o,n+=s.chunkSize()}return n}while(!e.lines);for(var r=0,i=e.lines.length;i>r;++r){var u=e.lines[r],a=u.height;if(a>t)break;t-=a}return n+r}function Ar(e,t){t=Qn(e.doc,t);for(var n=0,r=t.parent,i=0;i<r.lines.length;++i){var s=r.lines[i];if(s==t)break;n+=s.height}for(var o=r.parent;o;r=o,o=r.parent)for(var i=0;i<o.children.length;++i){var u=o.children[i];if(u==r)break;n+=u.height}return n}function Or(e){var t=e.order;return null==t&&(t=e.order=Gs(e.text)),t}function Mr(e){return{done:[],undone:[],undoDepth:1/0,lastTime:0,lastOp:null,lastOrigin:null,generation:e||1,maxGeneration:e||1}}function _r(e,t,n,r){var i=t["spans_"+e.id],s=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,r),function(n){n.markedSpans&&((i||(i=t["spans_"+e.id]={}))[s]=n.markedSpans),++s})}function Dr(e,t){var n={line:t.from.line,ch:t.from.ch},r={from:n,to:ms(t),text:Tr(e,t.from,t.to)};return _r(e,r,t.from.line,t.to.line+1),Er(e,function(e){_r(e,r,t.from.line,t.to.line+1)},!0),r}function Pr(e,t,n,r){var i=e.history;i.undone.length=0;var s=+(new Date),o=oi(i.done);if(o&&(i.lastOp==r||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&i.lastTime>s-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))){var u=oi(o.changes);Qt(t.from,t.to)&&Qt(t.from,u.to)?u.to=ms(t):o.changes.push(Dr(e,t)),o.anchorAfter=n.anchor,o.headAfter=n.head}else for(o={changes:[Dr(e,t)],generation:i.generation,anchorBefore:e.sel.anchor,headBefore:e.sel.head,anchorAfter:n.anchor,headAfter:n.head},i.done.push(o);i.done.length>i.undoDepth;)i.done.shift();i.generation=++i.maxGeneration,i.lastTime=s,i.lastOp=r,i.lastOrigin=t.origin,u||Gr(e,"historyAdded")}function Hr(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function Br(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var r=0,i=[];r<t.text.length;++r)i.push(Hr(n[r]));return i}function jr(e,t){for(var n=0,r=[];n<e.length;++n){var i=e[n],s=i.changes,o=[];r.push({changes:o,anchorBefore:i.anchorBefore,headBefore:i.headBefore,anchorAfter:i.anchorAfter,headAfter:i.headAfter});for(var u=0;u<s.length;++u){var a,f=s[u];if(o.push({from:f.from,to:f.to,text:f.text}),t)for(var l in f)(a=l.match(/^spans_(\d+)$/))&&ai(t,Number(a[1]))>-1&&(oi(o)[l]=f[l],delete f[l])}}return r}function Fr(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function Ir(e,t,n,r){for(var i=0;i<e.length;++i){for(var s=e[i],o=!0,u=0;u<s.changes.length;++u){var a=s.changes[u];if(s.copied||(a.from=Zt(a.from),a.to=Zt(a.to)),n<a.from.line)a.from.line+=r,a.to.line+=r;else if(t<=a.to.line){o=!1;break}}s.copied||(s.anchorBefore=Zt(s.anchorBefore),s.headBefore=Zt(s.headBefore),s.anchorAfter=Zt(s.anchorAfter),s.readAfter=Zt(s.headAfter),s.copied=!0),o?(Fr(s.anchorBefore),Fr(s.headBefore),Fr(s.anchorAfter),Fr(s.headAfter)):(e.splice(0,i+1),i=0)}}function qr(e,t){var n=t.from.line,r=t.to.line,i=t.text.length-(r-n)-1;Ir(e.done,n,r,i),Ir(e.undone,n,r,i)}function Rr(){Vr(this)}function Ur(e){return e.stop||(e.stop=Rr),e}function zr(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Wr(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Xr(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function Vr(e){zr(e),Wr(e)}function $r(e){return e.target||e.srcElement}function Jr(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),Zi&&e.ctrlKey&&1==t&&(t=3),t}function Kr(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var r=e._handlers||(e._handlers={}),i=r[t]||(r[t]=[]);i.push(n)}}function Qr(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var r=e._handlers&&e._handlers[t];if(!r)return;for(var i=0;i<r.length;++i)if(r[i]==n){r.splice(i,1);break}}}function Gr(e,t){var n=e._handlers&&e._handlers[t];if(n)for(var r=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,r)}function Yr(e,t){function n(e){return function(){e.apply(null,i)}}var r=e._handlers&&e._handlers[t];if(r){var i=Array.prototype.slice.call(arguments,2);Bs||(++js,Bs=[],setTimeout(ei,0));for(var s=0;s<r.length;++s)Bs.push(n(r[s]))}}function Zr(e,t,n){return Gr(e,n||t.type,e,t),Xr(t)||t.codemirrorIgnore}function ei(){--js;var e=Bs;Bs=null;for(var t=0;t<e.length;++t)e[t]()}function ti(e,t){var n=e._handlers&&e._handlers[t];return n&&n.length>0}function ni(e){e.prototype.on=function(e,t){Kr(this,e,t)},e.prototype.off=function(e,t){Qr(this,e,t)}}function ri(){this.id=null}function ii(e,t,n,r,i){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var s=r||0,o=i||0;t>s;++s)"  "==e.charAt(s)?o+=n-o%n:++o;return o}function si(e){for(;qs.length<=e;)qs.push(oi(qs)+" ");return qs[e]}function oi(e){return e[e.length-1]}function ui(e){if(Gi)e.selectionStart=0,e.selectionEnd=e.value.length;else try{e.select()}catch(t){}}function ai(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;r>n;++n)if(e[n]==t)return n;return-1}function fi(e,t){function n(){}n.prototype=e;var r=new n;return t&&li(t,r),r}function li(e,t){t||(t={});for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function ci(e){for(var t=[],n=0;e>n;++n)t.push(void 0);return t}function hi(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function pi(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Rs.test(e))}function di(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function vi(e){return e.charCodeAt(0)>=768&&Us.test(e)}function mi(e,t,n,r){var i=document.createElement(e);if(n&&(i.className=n),r&&(i.style.cssText=r),"string"==typeof t)bi(i,t);else if(t)for(var s=0;s<t.length;++s)i.appendChild(t[s]);return i}function gi(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function yi(e,t){return gi(e).appendChild(t)}function bi(e,t){Ii?(e.innerHTML="",e.appendChild(document.createTextNode(t))):e.textContent=t}function wi(e){return e.getBoundingClientRect()}function Ei(){return!1}function Si(e){if(null!=Ws)return Ws;var t=mi("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return yi(e,t),t.offsetWidth&&(Ws=t.offsetHeight-t.clientHeight),Ws||0}function xi(e){if(null==Xs){var t=mi("span","​");yi(e,mi("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Xs=t.offsetWidth<=1&&t.offsetHeight>2&&!Fi)}return Xs?mi("span","​"):mi("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")}function Ti(e,t,n,r){if(!e)return r(t,n,"ltr");for(var i=!1,s=0;s<e.length;++s){var o=e[s];(o.from<n&&o.to>t||t==n&&o.to==t)&&(r(Math.max(o.from,t),Math.min(o.to,n),1==o.level?"rtl":"ltr"),i=!0)}i||r(t,n,"ltr")}function Ni(e){return e.level%2?e.to:e.from}function Ci(e){return e.level%2?e.from:e.to}function ki(e){var t=Or(e);return t?Ni(t[0]):0}function Li(e){var t=Or(e);return t?Ci(oi(t)):e.text.length}function Ai(e,t){var n=xr(e.doc,t),r=Qn(e.doc,n);r!=n&&(t=kr(r));var i=Or(r),s=i?i[0].level%2?Li(r):ki(r):0;return Kt(t,s)}function Oi(e,t){for(var n,r;n=Jn(r=xr(e.doc,t));)t=n.find().to.line;var i=Or(r),s=i?i[0].level%2?ki(r):Li(r):r.text.length;return Kt(t,s)}function Mi(e,t,n){var r=e[0].level;return t==r?!0:n==r?!1:n>t}function _i(e,t){Qs=null;for(var n,r=0;r<e.length;++r){var i=e[r];if(i.from<t&&i.to>t)return r;if(i.from==t||i.to==t){if(null!=n)return Mi(e,i.level,e[n].level)?(i.from!=i.to&&(Qs=n),r):(i.from!=i.to&&(Qs=r),n);n=r}}return n}function Di(e,t,n,r){if(!r)return t+n;do t+=n;while(t>0&&vi(e.text.charAt(t)));return t}function Pi(e,t,n,r){var i=Or(e);if(!i)return Hi(e,t,n,r);for(var s=_i(i,t),o=i[s],u=Di(e,t,o.level%2?-n:n,r);;){if(u>o.from&&u<o.to)return u;if(u==o.from||u==o.to)return _i(i,u)==s?u:(o=i[s+=n],n>0==o.level%2?o.to:o.from);if(o=i[s+=n],!o)return null;u=n>0==o.level%2?Di(e,o.to,-1,r):Di(e,o.from,1,r)}}function Hi(e,t,n,r){var i=t+n;if(r)for(;i>0&&vi(e.text.charAt(i));)i+=n;return 0>i||i>e.text.length?null:i}var Bi=/gecko\/\d/i.test(navigator.userAgent),ji=/MSIE \d/.test(navigator.userAgent),Fi=ji&&(null==document.documentMode||document.documentMode<8),Ii=ji&&(null==document.documentMode||document.documentMode<9),qi=/Trident\/([7-9]|\d{2,})\./.test(navigator.userAgent),Ri=ji||qi,Ui=/WebKit\//.test(navigator.userAgent),zi=Ui&&/Qt\/\d+\.\d+/.test(navigator.userAgent),Wi=/Chrome\//.test(navigator.userAgent),Xi=/Opera\//.test(navigator.userAgent),Vi=/Apple Computer/.test(navigator.vendor),$i=/KHTML\//.test(navigator.userAgent),Ji=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),Ki=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),Qi=/PhantomJS/.test(navigator.userAgent),Gi=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),Yi=Gi||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),Zi=Gi||/Mac/.test(navigator.platform),es=/win/i.test(navigator.platform),ts=Xi&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);ts&&(ts=Number(ts[1])),ts&&ts>=15&&(Xi=!1,Ui=!0);var ns,rs,is,ss=Zi&&(zi||Xi&&(null==ts||12.11>ts)),os=Bi||Ri&&!Ii,us=!1,as=!1,fs=0,ls=0,cs=0,hs=null;Ri?hs=-0.53:Bi?hs=15:Wi?hs=-0.7:Vi&&(hs=-1/3);var ps,ds,vs=null,ms=e.changeEnd=function(e){return e.text?Kt(e.from.line+e.text.length-1,oi(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};e.Pos=Kt,e.prototype={constructor:e,focus:function(){window.focus(),vt(this),ht(this)},setOption:function(e,t){var n=this.options,r=n[e];(n[e]!=t||"mode"==e)&&(n[e]=t,gs.hasOwnProperty(e)&&ut(this,gs[e])(this,t,r))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](e)},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||"string"!=typeof t[n]&&t[n].name==e)return t.splice(n,1),!0},addOverlay:ut(null,function(t,n){var r=t.token?t:e.getMode(this.options,t);if(r.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:r,modeSpec:t,opaque:n&&n.opaque}),this.state.modeGen++,lt(this)}),removeOverlay:ut(null,function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var r=t[n].modeSpec;if(r==e||"string"==typeof e&&r.name==e)return t.splice(n,1),this.state.modeGen++,lt(this),void 0}}),indentLine:ut(null,function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),rn(this.doc,e)&&mn(this,e,t,n)}),indentSelection:ut(null,function(e){var t=this.doc.sel;if(Qt(t.from,t.to))return mn(this,t.from.line,e,!0);for(var n=t.to.line-(t.to.ch?0:1),r=t.from.line;n>=r;++r)mn(this,r,e)}),getTokenAt:function(e,t){var n=this.doc;e=tn(n,e);for(var r=B(this,e.line,t),i=this.doc.mode,s=xr(n,e.line),o=new An(s.text,this.options.tabSize);o.pos<e.ch&&!o.eol();){o.start=o.pos;var u=i.token(o,r)}return{start:o.start,end:o.pos,string:o.current(),className:u||null,type:u||null,state:r}},getTokenTypeAt:function(e){e=tn(this.doc,e);var t=ar(this,xr(this.doc,e.line)),n=0,r=(t.length-1)/2,i=e.ch;if(0==i)return t[2];for(;;){var s=n+r>>1;if((s?t[2*s-1]:0)>=i)r=s;else{if(!(t[2*s+1]<i))return t[2*s+2];n=s+1}}},getModeAt:function(t){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(t).state).mode:n},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!Ts.hasOwnProperty(t))return Ts;var r=Ts[t],i=this.getModeAt(e);if("string"==typeof i[t])r[i[t]]&&n.push(r[i[t]]);else if(i[t])for(var s=0;s<i[t].length;s++){var o=r[i[t][s]];o&&n.push(o)}else i.helperType&&r[i.helperType]?n.push(r[i.helperType]):r[i.name]&&n.push(r[i.name]);for(var s=0;s<r._global.length;s++){var u=r._global[s];u.pred(i,this)&&-1==ai(n,u.val)&&n.push(u.val)}return n},getStateAfter:function(e,t){var n=this.doc;return e=en(n,null==e?n.first+n.size-1:e),B(this,e+1,t)},cursorCoords:function(e,t){var n,r=this.doc.sel;return n=null==e?r.head:"object"==typeof e?tn(this.doc,e):e?r.from:r.to,Z(this,n,t||"page")},charCoords:function(e,t){return Y(this,tn(this.doc,e),t||"page")},coordsChar:function(e,t){return e=G(this,e,t||"page"),tt(this,e.left,e.top)},lineAtHeight:function(e,t){return e=G(this,{top:e,left:0},t||"page").top,Lr(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var n=!1,r=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>r&&(e=r,n=!0);var i=xr(this.doc,e);return Q(this,xr(this.doc,e),{top:0,left:0},t||"page").top+(n?i.height:0)},defaultTextHeight:function(){return rt(this.display)},defaultCharWidth:function(){return it(this.display)},setGutterMarker:ut(null,function(e,t,n){return gn(this,e,function(e){var r=e.gutterMarkers||(e.gutterMarkers={});return r[t]=n,!n&&di(r)&&(e.gutterMarkers=null),!0})}),clearGutter:ut(null,function(e){var t=this,n=t.doc,r=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,lt(t,r,r+1),di(n.gutterMarkers)&&(n.gutterMarkers=null)),++r})}),addLineClass:ut(null,function(e,t,n){return gn(this,e,function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"wrapClass";if(e[r]){if((new RegExp("(?:^|\\s)"+n+"(?:$|\\s)")).test(e[r]))return!1;e[r]+=" "+n}else e[r]=n;return!0})}),removeLineClass:ut(null,function(e,t,n){return gn(this,e,function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"wrapClass",i=e[r];if(!i)return!1;if(null==n)e[r]=null;else{var s=i.match(new RegExp("(?:^|\\s+)"+n+"(?:$|\\s+)"));if(!s)return!1;var o=s.index+s[0].length;e[r]=i.slice(0,s.index)+(s.index&&o!=i.length?" ":"")+i.slice(o)||null}return!0})}),addLineWidget:ut(null,function(e,t,n){return rr(this,e,t,n)}),removeLineWidget:function(e){e.clear()},lineInfo:function(e){if("number"==typeof e){if(!rn(this.doc,e))return null;var t=e;if(e=xr(this.doc,e),!e)return null}else{var t=kr(e);if(null==t)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(e,t,n,r,i){var s=this.display;e=Z(this,tn(this.doc,e));var o=e.bottom,u=e.left;if(t.style.position="absolute",s.sizer.appendChild(t),"over"==r)o=e.top;else if("above"==r||"near"==r){var a=Math.max(s.wrapper.clientHeight,this.doc.height),f=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth);("above"==r||e.bottom+t.offsetHeight>a)&&e.top>t.offsetHeight?o=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=a&&(o=e.bottom),u+t.offsetWidth>f&&(u=f-t.offsetWidth)}t.style.top=o+"px",t.style.left=t.style.right="","right"==i?(u=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?u=0:"middle"==i&&(u=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=u+"px"),n&&hn(this,u,o,u+t.offsetWidth,o+t.offsetHeight)},triggerOnKeyDown:ut(null,Pt),triggerOnKeyPress:ut(null,Ht),triggerOnKeyUp:ut(null,Dt),execCommand:function(e){return Ns.hasOwnProperty(e)?Ns[e](this):void 0},findPosH:function(e,t,n,r){var i=1;0>t&&(i=-1,t=-t);for(var s=0,o=tn(this.doc,e);t>s&&(o=yn(this.doc,o,i,n,r),!o.hitSide);++s);return o},moveH:ut(null,function(e,t){var n,r=this.doc.sel;n=r.shift||r.extend||Qt(r.from,r.to)?yn(this.doc,r.head,e,t,this.options.rtlMoveVisually):0>e?r.from:r.to,sn(this.doc,n,n,e)}),deleteH:ut(null,function(e,t){var n=this.doc.sel;Qt(n.from,n.to)?Jt(this.doc,"",n.from,yn(this.doc,n.head,e,t,!1),"+delete"):Jt(this.doc,"",n.from,n.to,"+delete"),this.curOp.userSelChange=!0}),findPosV:function(e,t,n,r){var i=1,s=r;0>t&&(i=-1,t=-t);for(var o=0,u=tn(this.doc,e);t>o;++o){var a=Z(this,u,"div");if(null==s?s=a.left:a.left=s,u=bn(this,a,i,n),u.hitSide)break}return u},moveV:ut(null,function(e,t){var n,r,i=this.doc.sel;if(i.shift||i.extend||Qt(i.from,i.to)){var s=Z(this,i.head,"div");null!=i.goalColumn&&(s.left=i.goalColumn),n=bn(this,s,e,t),"page"==t&&vn(this,0,Y(this,n,"div").top-s.top),r=s.left}else n=0>e?i.from:i.to;sn(this.doc,n,n,e),null!=r&&(i.goalColumn=r)}),toggleOverwrite:function(e){(null==e||e!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?this.display.cursor.className+=" CodeMirror-overwrite":this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite",""),Gr(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return document.activeElement==this.display.input},scrollTo:ut(null,function(e,t){dn(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller,t=Fs;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-t,width:e.scrollWidth-t,clientHeight:e.clientHeight-t,clientWidth:e.clientWidth-t}},scrollIntoView:ut(null,function(e,t){null==e?e={from:this.doc.sel.head,to:null}:"number"==typeof e?e={from:Kt(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),t||(t=0);var n=e;null!=e.from.line&&(this.curOp.scrollToPos={from:e.from,to:e.to,margin:t},n={from:Z(this,e.from),to:Z(this,e.to)});var r=pn(this,Math.min(n.from.left,n.to.left),Math.min(n.from.top,n.to.top)-t,Math.max(n.from.right,n.to.right),Math.max(n.from.bottom,n.to.bottom)+t);dn(this,r.scrollLeft,r.scrollTop)}),setSize:ut(null,function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}null!=e&&(this.display.wrapper.style.width=n(e)),null!=t&&(this.display.wrapper.style.height=n(t)),this.options.lineWrapping&&(this.display.measureLineCache.length=this.display.measureLineCachePos=0),this.curOp.forceUpdate=!0,Gr(this,"refresh",this)}),operation:function(e){return ft(this,e)},refresh:ut(null,function(){var e=this.display.cachedTextHeight;$(this),dn(this,this.doc.scrollLeft,this.doc.scrollTop),lt(this),(null==e||Math.abs(e-rt(this.display))>.5)&&o(this),Gr(this,"refresh",this)}),swapDoc:ut(null,function(e){var t=this.doc;return t.cm=null,Sr(this,e),$(this),dt(this,!0),dn(this,e.scrollLeft,e.scrollTop),Yr(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},ni(e);var gs=e.optionHandlers={},ys=e.defaults={},bs=e.Init={toString:function(){return"CodeMirror.Init"}};Sn("value","",function(e,t){e.setValue(t)},!0),Sn("mode",null,function(e,t){e.doc.modeOption=t,n(e)},!0),Sn("indentUnit",2,n,!0),Sn("indentWithTabs",!1),Sn("smartIndent",!0),Sn("tabSize",4,function(e){r(e),$(e),lt(e)},!0),Sn("specialChars",/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\ufeff]/g,function(e,t){e.options.specialChars=new RegExp(t.source+(t.test(" ")?"":"|  "),"g"),e.refresh()},!0),Sn("specialCharPlaceholder",hr,function(e){e.refresh()},!0),Sn("electricChars",!0),Sn("rtlMoveVisually",!es),Sn("wholeLineUpdateBefore",!0),Sn("theme","default",function(e){a(e),f(e)},!0),Sn("keyMap","default",u),Sn("extraKeys",null),Sn("onKeyEvent",null),Sn("onDragEvent",null),Sn("lineWrapping",!1,i,!0),Sn("gutters",[],function(e){p(e.options),f(e)},!0),Sn("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?b(e.display)+"px":"0",e.refresh()},!0),Sn("coverGutterNextToScrollbar",!1,d,!0),Sn("lineNumbers",!1,function(e){p(e.options),f(e)},!0),Sn("firstLineNumber",1,f,!0),Sn("lineNumberFormatter",function(e){return e},f,!0),Sn("showCursorWhenSelecting",!1,A,!0),Sn("resetSelectionOnContextMenu",!0),Sn("readOnly",!1,function(e,t){"nocursor"==t?(jt(e),e.display.input.blur(),e.display.disabled=!0):(e.display.disabled=!1,t||dt(e,!0))}),Sn("disableInput",!1,function(e,t){t||dt(e,!0)},!0),Sn("dragDrop",!0),Sn("cursorBlinkRate",530),Sn("cursorScrollMargin",0),Sn("cursorHeight",1),Sn("workTime",100),Sn("workDelay",100),Sn("flattenSpans",!0,r,!0),Sn("addModeClass",!1,r,!0),Sn("pollInterval",100),Sn("undoDepth",40,function(e,t){e.doc.history.undoDepth=t}),Sn("historyEventDelay",500),Sn("viewportMargin",10,function(e){e.refresh()},!0),Sn("maxHighlightLength",1e4,r,!0),Sn("crudeMeasuringFrom",1e4),Sn("moveInputWithCursor",!0,function(e,t){t||(e.display.inputDiv.style.top=e.display.inputDiv.style.left=0)}),Sn("tabindex",null,function(e,t){e.display.input.tabIndex=t||""}),Sn("autofocus",null);var ws=e.modes={},Es=e.mimeModes={};e.defineMode=function(t,n){if(e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2){n.dependencies=[];for(var r=2;r<arguments.length;++r)n.dependencies.push(arguments[r])}ws[t]=n},e.defineMIME=function(e,t){Es[e]=t},e.resolveMode=function(t){if("string"==typeof t&&Es.hasOwnProperty(t))t=Es[t];else if(t&&"string"==typeof t.name&&Es.hasOwnProperty(t.name)){var n=Es[t.name];t=fi(n,t),t.name=n.name}else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,n){var n=e.resolveMode(n),r=ws[n.name];if(!r)return e.getMode(t,"text/plain");var i=r(t,n);if(Ss.hasOwnProperty(n.name)){var s=Ss[n.name];for(var o in s)s.hasOwnProperty(o)&&(i.hasOwnProperty(o)&&(i["_"+o]=i[o]),i[o]=s[o])}if(i.name=n.name,n.helperType&&(i.helperType=n.helperType),n.modeProps)for(var o in n.modeProps)i[o]=n.modeProps[o];return i},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var Ss=e.modeExtensions={};e.extendMode=function(e,t){var n=Ss.hasOwnProperty(e)?Ss[e]:Ss[e]={};li(t,n)},e.defineExtension=function(t,n){e.prototype[t]=n},e.defineDocExtension=function(e,t){Ds.prototype[e]=t},e.defineOption=Sn;var xs=[];e.defineInitHook=function(e){xs.push(e)};var Ts=e.helpers={};e.registerHelper=function(t,n,r){Ts.hasOwnProperty(t)||(Ts[t]=e[t]={_global:[]}),Ts[t][n]=r},e.registerGlobalHelper=function(t,n,r,i){e.registerHelper(t,n,i),Ts[t]._global.push({pred:r,val:i})},e.isWordChar=pi,e.copyState=xn,e.startState=Tn,e.innerMode=function(e,t){for(;e.innerMode;){var n=e.innerMode(t);if(!n||n.mode==e)break;t=n.state,e=n.mode}return n||{mode:e,state:t}};var Ns=e.commands={selectAll:function(e){e.setSelection(Kt(e.firstLine(),0),Kt(e.lastLine()))},killLine:function(e){var t=e.getCursor(!0),n=e.getCursor(!1),r=!Qt(t,n);r||e.getLine(t.line).length!=t.ch?e.replaceRange("",t,r?n:Kt(t.line),"+delete"):e.replaceRange("",t,Kt(t.line+1,0),"+delete")},deleteLine:function(e){var t=e.getCursor().line;e.replaceRange("",Kt(t,0),Kt(t),"+delete")},delLineLeft:function(e){var t=e.getCursor();e.replaceRange("",Kt(t.line,0),t,"+delete")},undo:function(e){e.undo()},redo:function(e){e.redo()},goDocStart:function(e){e.extendSelection(Kt(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(Kt(e.lastLine()))},goLineStart:function(e){e.extendSelection(Ai(e,e.getCursor().line))},goLineStartSmart:function(e){var t=e.getCursor(),n=Ai(e,t.line),r=e.getLineHandle(n.line),i=Or(r);if(i&&0!=i[0].level)e.extendSelection(n);else{var s=Math.max(0,r.text.search(/\S/)),o=t.line==n.line&&t.ch<=s&&t.ch;e.extendSelection(Kt(n.line,o?0:s))}},goLineEnd:function(e){e.extendSelection(Oi(e,e.getCursor().line))},goLineRight:function(e){var t=e.charCoords(e.getCursor(),"div").top+5;e.extendSelection(e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:t},"div"))},goLineLeft:function(e){var t=e.charCoords(e.getCursor(),"div").top+5;e.extendSelection(e.coordsChar({left:0,top:t},"div"))},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("  ","end","+input")},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.replaceSelection(" ","end","+input")},transposeChars:function(e){var t=e.getCursor(),n=e.getLine(t.line);t.ch>0&&t.ch<n.length-1&&e.replaceRange(n.charAt(t.ch)+n.charAt(t.ch-1),Kt(t.line,t.ch-1),Kt(t.line,t.ch+1))},newlineAndIndent:function(e){ut(e,function(){e.replaceSelection("\n","end","+input"),e.indentLine(e.getCursor().line,null,!0)})()},toggleOverwrite:function(e){e.toggleOverwrite()}},Cs=e.keyMap={};Cs.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},Cs.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},Cs.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft",fallthrough:["basic","emacsy"]},Cs["default"]=Zi?Cs.macDefault:Cs.pcDefault,Cs.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},e.lookupKey=Cn,e.isModifierKey=kn,e.keyName=Ln,e.fromTextArea=function(t,n){function r(){t.value=f.getValue()}if(n||(n={}),n.value=t.value,!n.tabindex&&t.tabindex&&(n.tabindex=t.tabindex),!n.placeholder&&t.placeholder&&(n.placeholder=t.placeholder),null==n.autofocus){var i=document.body;try{i=document.activeElement}catch(s){}n.autofocus=i==t||null!=t.getAttribute("autofocus")&&i==document.body}if(t.form&&(Kr(t.form,"submit",r),!n.leaveSubmitMethodAlone)){var o=t.form,u=o.submit;try{var a=o.submit=function(){r(),o.submit=u,o.submit(),o.submit=a}}catch(s){}}t.style.display="none";var f=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},n);return f.save=r,f.getTextArea=function(){return t},f.toTextArea=function(){r(),t.parentNode.removeChild(f.getWrapperElement()),t.style.display="",t.form&&(Qr(t.form,"submit",r),"function"==typeof t.form.submit&&(t.form.submit=u))},f},An.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var n=t==e;else var n=t&&(e.test?e.test(t):e(t));return n?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=ii(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?ii(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return ii(this.string,null,this.tabSize)-(this.lineStart?ii(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,n){if("string"!=typeof e){var r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}var i=function(e){return n?e.toLowerCase():e},s=this.string.substr(this.pos,e.length);return i(s)==i(e)?(t!==!1&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}},e.StringStream=An,e.TextMarker=On,ni(On),On.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&st(e),ti(this,"clear")){var n=this.find();n&&Yr(this,"clear",n.from,n.to)}for(var r=null,i=null,s=0;s<this.lines.length;++s){var o=this.lines[s],u=Pn(o.markedSpans,this);null!=u.to&&(i=kr(o)),o.markedSpans=Hn(o.markedSpans,u),null!=u.from?r=kr(o):this.collapsed&&!Gn(this.doc,o)&&e&&Cr(o,rt(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var s=0;s<this.lines.length;++s){var a=Qn(e.doc,this.lines[s]),f=c(e.doc,a);f>e.display.maxLineLength&&(e.display.maxLine=a,e.display.maxLineLength=f,e.display.maxLineChanged=!0)}null!=r&&e&&lt(e,r,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&an(e)),t&&ot(e)}},On.prototype.find=function(e){for(var t,n,r=0;r<this.lines.length;++r){var i=this.lines[r],s=Pn(i.markedSpans,this);if(null!=s.from||null!=s.to){var o=kr(i);null!=s.from&&(t=Kt(o,s.from)),null!=s.to&&(n=Kt(o,s.to))}}return"bookmark"!=this.type||e?t&&{from:t,to:n}:t},On.prototype.changed=function(){var e=this.find(),t=this.doc.cm;if(e&&t){"bookmark"!=this.type&&(e=e.from);var n=xr(this.doc,e.line);if(U(t,n),e.line>=t.display.showingFrom&&e.line<t.display.showingTo){for(var r=t.display.lineDiv.firstChild;r;r=r.nextSibling)if(r.lineObj==n){r.offsetHeight!=n.height&&Cr(n,r.offsetHeight);break}ft(t,function(){t.curOp.selectionChanged=t.curOp.forceUpdate=t.curOp.updateMaxLine=!0})}}},On.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=ai(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},On.prototype.detachLine=function(e){if(this.lines.splice(ai(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};var ks=0;e.SharedTextMarker=_n,ni(_n),_n.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();Yr(this,"clear")}},_n.prototype.find=function(){return this.primary.find()};var Ls=e.LineWidget=function(e,t,n){if(n)for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.cm=e,this.node=t};ni(Ls),Ls.prototype.clear=tr(function(){var e=this.line.widgets,t=kr(this.line);if(null!=t&&e){for(var n=0;n<e.length;++n)e[n]==this&&e.splice(n--,1);e.length||(this.line.widgets=null);var r=Ar(this.cm,this.line)<this.cm.doc.scrollTop;Cr(this.line,Math.max(0,this.line.height-nr(this))),r&&vn(this.cm,0,-this.height),lt(this.cm,t,t+1)}}),Ls.prototype.changed=tr(function(){var e=this.height;this.height=null;var t=nr(this)-e;if(t){Cr(this.line,this.line.height+t);var n=kr(this.line);lt(this.cm,n,n+1)}});var As=e.Line=function(e,t,n){this.text=e,er(this,t),this.height=n?n(this):1};ni(As),As.prototype.lineNo=function(){return kr(this)};var Os={},Ms={};br.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,r=e+t;r>n;++n){var i=this.lines[n];this.height-=i.height,sr(i),Yr(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.splice.apply(e,[e.length,0].concat(this.lines))},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0,i=t.length;i>r;++r)t[r].parent=this},iterN:function(e,t,n){for(var r=e+t;r>e;++e)if(n(this.lines[e]))return!0}},wr.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var r=this.children[n],i=r.chunkSize();if(i>e){var s=Math.min(t,i-e),o=r.height;if(r.removeInner(e,s),this.height-=o-r.height,i==s&&(this.children.splice(n--,1),r.parent=null),0==(t-=s))break;e=0}else e-=i}if(this.size-t<25){var u=[];this.collapse(u),this.children=[new br(u)],this.children[0].parent=this}},collapse:function(e){for(var t=0,n=this.children.length;n>t;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var r=0,i=this.children.length;i>r;++r){var s=this.children[r],o=s.chunkSize();if(o>=e){if(s.insertInner(e,t,n),s.lines&&s.lines.length>50){for(;s.lines.length>50;){var u=s.lines.splice(s.lines.length-25,25),a=new br(u);s.height-=a.height,this.children.splice(r+1,0,a),a.parent=this}this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new wr(t);if(e.parent){e.size-=n.size,e.height-=n.height;var r=ai(e.parent.children,e);e.parent.children.splice(r+1,0,n)}else{var i=new wr(e.children);i.parent=e,e.children=[i,n],e=i}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var r=0,i=this.children.length;i>r;++r){var s=this.children[r],o=s.chunkSize();if(o>e){var u=Math.min(t,o-e);if(s.iterN(e,u,n))return!0;if(0==(t-=u))break;e=0}else e-=o}}};var _s=0,Ds=e.Doc=function(e,t,n){if(!(this instanceof Ds))return new Ds(e,t,n);null==n&&(n=0),wr.call(this,[new br([new As("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.history=Mr(),this.cleanGeneration=1,this.frontier=n;var r=Kt(n,0);this.sel={from:r,to:r,head:r,anchor:r,shift:!1,extend:!1,goalColumn:null},this.id=++_s,this.modeOption=t,"string"==typeof e&&(e=Vs(e)),yr(this,{from:r,to:r,text:e},null,{head:r,anchor:r})};Ds.prototype=fi(wr.prototype,{constructor:Ds,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,r=0,i=t.length;i>r;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Nr(this,this.first,this.first+this.size);return e===!1?t:t.join(e||"\n")},setValue:function(e){var t=Kt(this.first,0),n=this.first+this.size-1;Ut(this,{from:t,to:Kt(n,xr(this,n).text.length),text:Vs(e),origin:"setValue"},{head:t,anchor:t},!0)},replaceRange:function(e,t,n,r){t=tn(this,t),n=n?tn(this,n):t,Jt(this,e,t,n,r)},getRange:function(e,t,n){var r=Tr(this,tn(this,e),tn(this,t));return n===!1?r:r.join(n||"\n")},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},setLine:function(e,t){rn(this,e)&&Jt(this,t,Kt(e,0),tn(this,Kt(e)))},removeLine:function(e){e?Jt(this,"",tn(this,Kt(e-1)),tn(this,Kt(e))):Jt(this,"",Kt(0,0),tn(this,Kt(1,0)))},getLineHandle:function(e){return rn(this,e)?xr(this,e):void 0},getLineNumber:function(e){return kr(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=xr(this,e)),Qn(this,e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return tn(this,e)},getCursor:function(e){var t,n=this.sel;return t=null==e||"head"==e?n.head:"anchor"==e?n.anchor:"end"==e||e===!1?n.to:n.from,Zt(t)},somethingSelected:function(){return!Qt(this.sel.head,this.sel.anchor)},setCursor:at(function(e,t,n){var r=tn(this,"number"==typeof e?Kt(e,t||0):e);n?sn(this,r):un(this,r,r)}),setSelection:at(function(e,t,n){un(this,tn(this,e),tn(this,t||e),n)}),extendSelection:at(function(e,t,n){sn(this,tn(this,e),t&&tn(this,t),n)}),getSelection:function(e){return this.getRange(this.sel.from,this.sel.to,e)},replaceSelection:function(e,t,n){Ut(this,{from:this.sel.from,to:this.sel.to,text:Vs(e),origin:n},t||"around")},undo:at(function(){Wt(this,"undo")}),redo:at(function(){Wt(this,"redo")}),setExtending:function(e){this.sel.extend=e},historySize:function(){var e=this.history;return{undo:e.done.length,redo:e.undone.length}},clearHistory:function(){this.history=Mr(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:jr(this.history.done),undone:jr(this.history.undone)}},setHistory:function(e){var t=this.history=Mr(this.history.maxGeneration);t.done=e.done.slice(0),t.undone=e.undone.slice(0)},markText:function(e,t,n){return Mn(this,tn(this,e),tn(this,t),n,"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1};return e=tn(this,e),Mn(this,e,e,n,"bookmark")},findMarksAt:function(e){e=tn(this,e);var t=[],n=xr(this,e.line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var r=0;r<n.length;++r)null!=n[r].from&&e.push(n[r].marker)}),e},posFromIndex:function(e){var t,n=this.first;return this.iter(function(r){var i=r.text.length+1;return i>e?(t=e,!0):(e-=i,++n,void 0)}),tn(this,Kt(n,t))},indexFromPos:function(e){e=tn(this,e);var t=e.ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new Ds(Nr(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:!1,goalColumn:this.sel.goalColumn},e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var r=new Ds(Nr(this,t,n),e.mode||this.modeOption,t);return e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],r},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var n=0;n<this.linked.length;++n){var r=this.linked[n];if(r.doc==t){this.linked.splice(n,1),t.unlinkDoc(this);break}}if(t.history==this.history){var i=[t.id];Er(t,function(e){i.push(e.id)},!0),t.history=Mr(),t.history.done=jr(this.history.done,i),t.history.undone=jr(this.history.undone,i)}},iterLinkedDocs:function(e){Er(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),Ds.prototype.eachLine=Ds.prototype.iter;var Ps="iter insert remove copy getEditor".split(" ");for(var Hs in Ds.prototype)Ds.prototype.hasOwnProperty(Hs)&&ai(Ps,Hs)<0&&(e.prototype[Hs]=function(e){return function(){return e.apply(this.doc,arguments)}}(Ds.prototype[Hs]));ni(Ds),e.e_stop=Vr,e.e_preventDefault=zr,e.e_stopPropagation=Wr;var Bs,js=0;e.on=Kr,e.off=Qr,e.signal=Gr;var Fs=30,Is=e.Pass={toString:function(){return"CodeMirror.Pass"}};ri.prototype={set:function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)}},e.countColumn=ii;var qs=[""],Rs=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Us=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;e.replaceGetRect=function(e){wi=e};var zs=function(){if(Ii)return!1;var e=mi("div");return"draggable"in e||"dragDrop"in e}();Bi?Ei=function(e,t){return 36==e.charCodeAt(t-1)&&39==e.charCodeAt(t)}:Vi&&!/Version\/([6-9]|\d\d)\b/.test(navigator.userAgent)?Ei=function(e,t){return/\-[^ \-?]|\?[^ !\'\"\),.\-\/:;\?\]\}]/.test(e.slice(t-1,t+1))}:Ui&&/Chrome\/(?:29|[3-9]\d|\d\d\d)\./.test(navigator.userAgent)?Ei=function(e,t){var n=e.charCodeAt(t-1);return n>=8208&&8212>=n}:Ui&&(Ei=function(e,t){if(t>1&&45==e.charCodeAt(t-1)){if(/\w/.test(e.charAt(t-2))&&/[^\-?\.]/.test(e.charAt(t)))return!0;if(t>2&&/[\d\.,]/.test(e.charAt(t-2))&&/[\d\.,]/.test(e.charAt(t)))return!1}return/[~!#%&*)=+}\]\\|\"\.>,:;][({[<]|-[^\-?\.\u2010-\u201f\u2026]|\?[\w~`@#$%\^&*(_=+{[|><]|\u2026[\w~`@#$%\^&*(_=+{[><]/.test(e.slice(t-1,t+1))});var Ws,Xs,Vs=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],r=e.length;r>=t;){var i=e.indexOf("\n",t);-1==i&&(i=e.length);var s=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),o=s.indexOf("\r");-1!=o?(n.push(s.slice(0,o)),t+=o+1):(n.push(s),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)};e.splitLines=Vs;var $s=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return t&&t.parentElement()==e?0!=t.compareEndPoints("StartToEnd",t):!1},Js=function(){var e=mi("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),Ks={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};e.keyNames=Ks,function(){for(var e=0;10>e;e++)Ks[e+48]=Ks[e+96]=String(e);for(var e=65;90>=e;e++)Ks[e]=String.fromCharCode(e);for(var e=1;12>=e;e++)Ks[e+111]=Ks[e+63235]="F"+e}();var Qs,Gs=function(){function e(e){return 255>=e?t.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1791>=e?n.charAt(e-1536):e>=1792&&2220>=e?"r":"L"}var t="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,s=/[LRr]/,o=/[Lb1n]/,u=/[1n]/,a="L";return function(t){if(!r.test(t))return!1;for(var n,f=t.length,l=[],c=0;f>c;++c)l.push(n=e(t.charCodeAt(c)));for(var c=0,h=a;f>c;++c){var n=l[c];"m"==n?l[c]=h:h=n}for(var c=0,p=a;f>c;++c){var n=l[c];"1"==n&&"r"==p?l[c]="n":s.test(n)&&(p=n,"r"==n&&(l[c]="R"))}for(var c=1,h=l[0];f-1>c;++c){var n=l[c];"+"==n&&"1"==h&&"1"==l[c+1]?l[c]="1":","!=n||h!=l[c+1]||"1"!=h&&"n"!=h||(l[c]=h),h=n}for(var c=0;f>c;++c){var n=l[c];if(","==n)l[c]="N";else if("%"==n){for(var d=c+1;f>d&&"%"==l[d];++d);for(var v=c&&"!"==l[c-1]||f>d&&"1"==l[d]?"1":"N",m=c;d>m;++m)l[m]=v;c=d-1}}for(var c=0,p=a;f>c;++c){var n=l[c];"L"==p&&"1"==n?l[c]="L":s.test(n)&&(p=n)}for(var c=0;f>c;++c)if(i.test(l[c])){for(var d=c+1;f>d&&i.test(l[d]);++d);for(var g="L"==(c?l[c-1]:a),y="L"==(f>d?l[d]:a),v=g||y?"L":"R",m=c;d>m;++m)l[m]=v;c=d-1}for(var b,w=[],c=0;f>c;)if(o.test(l[c])){var E=c;for(++c;f>c&&o.test(l[c]);++c);w.push({from:E,to:c,level:0})}else{var S=c,x=w.length;for(++c;f>c&&"L"!=l[c];++c);for(var m=S;c>m;)if(u.test(l[m])){m>S&&w.splice(x,0,{from:S,to:m,level:1});var T=m;for(++m;c>m&&u.test(l[m]);++m);w.splice(x,0,{from:T,to:m,level:2}),S=m}else++m;c>S&&w.splice(x,0,{from:S,to:c,level:1})}return 1==w[0].level&&(b=t.match(/^\s+/))&&(w[0].from=b[0].length,w.unshift({from:0,to:b[0].length,level:0})),1==oi(w).level&&(b=t.match(/\s+$/))&&(oi(w).to-=b[0].length,w.push({from:f-b[0].length,to:f,level:0})),w[0].level!=oi(w).level&&w.push({from:f,to:f,level:w[0].level}),w}}();return e.version="3.21.1",e}(),CodeMirror.defineMode("markdown",function(e,t){function n(e,t,n){return t.f=t.inline=n,n(e,t)}function r(e,t,n){return t.f=t.block=n,n(e,t)}function i(e){return e.linkTitle=!1,e.em=!1,e.strong=!1,e.quote=0,y||e.f!=o||(e.f=l,e.block=s),e.trailingSpace=0,e.trailingSpaceNewLine=!1,e.thisLineHasContent=!1,null}function s(e,i){var s=e.sol(),o=i.list!==!1;i.list!==!1&&i.indentationDiff>=0?(i.indentationDiff<4&&(i.indentation-=i.indentationDiff),i.list=null):i.list!==!1&&i.indentation>0?(i.list=null,i.listDepth=Math.floor(i.indentation/4)):i.list!==!1&&(i.list=!1,i.listDepth=0);var f=null;if(i.indentationDiff>=4)return i.indentation-=4,e.skipToEnd(),T;if(e.eatSpace())return null;if(f=e.match(U))return i.header=f[0].length<=6?f[0].length:6,t.highlightFormatting&&(i.formatting="header"),i.f=i.inline,a(i);if(i.prevLineHasContent&&(f=e.match(z)))return i.header="="==f[0].charAt(0)?1:2,t.highlightFormatting&&(i.formatting="header"),i.f=i.inline,a(i);if(e.eat(">"))return i.indentation++,i.quote=s?1:i.quote+1,t.highlightFormatting&&(i.formatting="quote"),e.eatSpace(),a(i);if("["===e.peek())return n(e,i,d);if(e.match(F,!0))return A;if((!i.prevLineHasContent||o)&&(e.match(I,!1)||e.match(q,!1))){var l=null;return e.match(I,!0)?l="ul":(e.match(q,!0),l="ol"),i.indentation+=4,i.list=!0,i.listDepth++,t.taskLists&&e.match(R,!1)&&(i.taskList=!0),i.f=i.inline,t.highlightFormatting&&(i.formatting=["list","list-"+l]),a(i)}return t.fencedCodeBlocks&&e.match(/^```([\w+#]*)/,!0)?(i.localMode=E(RegExp.$1),i.localMode&&(i.localState=i.localMode.startState()),r(e,i,u),t.highlightFormatting&&(i.formatting="code-block"),i.code=!0,a(i)):n(e,i,i.inline)}function o(e,t){var n=b.token(e,t.htmlState);return(y&&!t.htmlState.tagName&&!t.htmlState.context||t.md_inside&&e.current().indexOf(">")>-1)&&(t.f=l,t.block=s,t.htmlState=null),n}function u(e,n){if(e.sol()&&e.match(/^```/,!0)){n.localMode=n.localState=null,n.f=l,n.block=s,t.highlightFormatting&&(n.formatting="code-block"),n.code=!0;var r=a(n);return n.code=!1,r}return n.localMode?n.localMode.token(e,n.localState):(e.skipToEnd(),T)}function a(e){var n=[];if(e.formatting){n.push(M),"string"==typeof e.formatting&&(e.formatting=[e.formatting]);for(var r=0;r<e.formatting.length;r++)n.push(M+"-"+e.formatting[r]),"header"===e.formatting[r]&&n.push(M+"-"+e.formatting[r]+"-"+e.header),"quote"===e.formatting[r]&&(!t.maxBlockquoteDepth||t.maxBlockquoteDepth>=e.quote?n.push(M+"-"+e.formatting[r]+"-"+e.quote):n.push("error"))}if(e.taskOpen)return n.push("meta"),n.length?n.join(" "):null;if(e.taskClosed)return n.push("property"),n.length?n.join(" "):null;if(e.linkHref)return n.push(H),n.length?n.join(" "):null;if(e.strong&&n.push(j),e.em&&n.push(B),e.linkText&&n.push(P),e.code&&n.push(T),e.header&&(n.push(x),n.push(x+"-"+e.header)),e.quote&&(n.push(N),!t.maxBlockquoteDepth||t.maxBlockquoteDepth>=e.quote?n.push(N+"-"+e.quote):n.push(N+"-"+t.maxBlockquoteDepth)),e.list!==!1){var i=(e.listDepth-1)%3;i?1===i?n.push(k):n.push(L):n.push(C)}return e.trailingSpaceNewLine?n.push("trailing-space-new-line"):e.trailingSpace&&n.push("trailing-space-"+(e.trailingSpace%2?"a":"b")),n.length?n.join(" "):null}function f(e,t){return e.match(W,!0)?a(t):void 0}function l(e,n){var i=n.text(e,n);if("undefined"!=typeof i)return i;if(n.list)return n.list=null,a(n);if(n.taskList){var s="x"!==e.match(R,!0)[1];return s?n.taskOpen=!0:n.taskClosed=!0,t.highlightFormatting&&(n.formatting="task"),n.taskList=!1,a(n)}if(n.taskOpen=!1,n.taskClosed=!1,n.header&&e.match(/^#+$/,!0))return t.highlightFormatting&&(n.formatting="header"),a(n);var u=e.sol(),f=e.next();if(n.escape)return n.escape=!1,a(n);if("\\"===f)return t.highlightFormatting&&(n.formatting="escape"),n.escape=!0,a(n);if(n.linkTitle){n.linkTitle=!1;var l=f;"("===f&&(l=")"),l=(l+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var p="^\\s*(?:[^"+l+"\\\\]+|\\\\\\\\|\\\\.)"+l;if(e.match(new RegExp(p),!0))return H}if("`"===f){var d=n.formatting;t.highlightFormatting&&(n.formatting="code");var v=a(n),m=e.pos;e.eatWhile("`");var g=1+e.pos-m;return n.code?g===S?(n.code=!1,v):(n.formatting=d,a(n)):(S=g,n.code=!0,a(n))}if(n.code)return a(n);if("!"===f&&e.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return e.match(/\[[^\]]*\]/),n.inline=n.f=h,O;if("["===f&&e.match(/.*\](\(| ?\[)/,!1))return n.linkText=!0,t.highlightFormatting&&(n.formatting="link"),a(n);if("]"===f&&n.linkText){t.highlightFormatting&&(n.formatting="link");var y=a(n);return n.linkText=!1,n.inline=n.f=h,y}if("<"===f&&e.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!1)){n.f=n.inline=c,t.highlightFormatting&&(n.formatting="link");var y=a(n);return y?y+=" ":y="",y+_}if("<"===f&&e.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1)){n.f=n.inline=c,t.highlightFormatting&&(n.formatting="link");var y=a(n);return y?y+=" ":y="",y+D}if("<"===f&&e.match(/^\w/,!1)){if(-1!=e.string.indexOf(">")){var w=e.string.substring(1,e.string.indexOf(">"));/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(w)&&(n.md_inside=!0)}return e.backUp(1),n.htmlState=CodeMirror.startState(b),r(e,n,o)}if("<"===f&&e.match(/^\/\w*?>/))return n.md_inside=!1,"tag";var E=!1;if(!t.underscoresBreakWords&&"_"===f&&"_"!==e.peek()&&e.match(/(\w)/,!1)){var x=e.pos-2;if(x>=0){var T=e.string.charAt(x);"_"!==T&&T.match(/(\w)/,!1)&&(E=!0)}}if("*"===f||"_"===f&&!E){if(!u||" "!==e.peek()){if(n.strong===f&&e.eat(f)){t.highlightFormatting&&(n.formatting="strong");var v=a(n);return n.strong=!1,v}if(!n.strong&&e.eat(f))return n.strong=f,t.highlightFormatting&&(n.formatting="strong"),a(n);if(n.em===f){t.highlightFormatting&&(n.formatting="em");var v=a(n);return n.em=!1,v}if(!n.em)return n.em=f,t.highlightFormatting&&(n.formatting="em"),a(n)}}else if(" "===f&&(e.eat("*")||e.eat("_"))){if(" "===e.peek())return a(n);e.backUp(1)}return" "===f&&(e.match(/ +$/,!1)?n.trailingSpace++:n.trailingSpace&&(n.trailingSpaceNewLine=!0)),a(n)}function c(e,n){var r=e.next();if(">"===r){n.f=n.inline=l,t.highlightFormatting&&(n.formatting="link");var i=a(n);return i?i+=" ":i="",i+_}return e.match(/^[^>]+/,!0),_}function h(e,n){if(e.eatSpace())return null;var r=e.next();return"("===r||"["===r?(n.f=n.inline=p("("===r?")":"]"),t.highlightFormatting&&(n.formatting="link-string"),n.linkHref=!0,a(n)):"error"}function p(e){return function(n,r){var i=n.next();if(i===e){r.f=r.inline=l,t.highlightFormatting&&(r.formatting="link-string");var s=a(r);return r.linkHref=!1,s}return n.match(g(e),!0)&&n.backUp(1),r.linkHref=!0,a(r)}}function d(e,r){return e.match(/^[^\]]*\]:/,!1)?(r.f=v,e.next(),t.highlightFormatting&&(r.formatting="link"),r.linkText=!0,a(r)):n(e,r,l)}function v(e,n){if(e.match(/^\]:/,!0)){n.f=n.inline=m,t.highlightFormatting&&(n.formatting="link");var r=a(n);return n.linkText=!1,r}return e.match(/^[^\]]+/,!0),P}function m(e,t){return e.eatSpace()?null:(e.match(/^[^\s]+/,!0),void 0===e.peek()?t.linkTitle=!0:e.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),t.f=t.inline=l,H)}function g(e){return X[e]||(e=(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),X[e]=new RegExp("^(?:[^\\\\]|\\\\.)*?("+e+")")),X[e]}var y=CodeMirror.modes.hasOwnProperty("xml"),b=CodeMirror.getMode(e,y?{name:"xml",htmlMode:!0}:"text/plain"),w={html:"htmlmixed",js:"javascript",json:"application/json",c:"text/x-csrc","c++":"text/x-c++src",java:"text/x-java",csharp:"text/x-csharp","c#":"text/x-csharp",scala:"text/x-scala"},E=function(){var t,n,r={},i={},s=[];for(var o in CodeMirror.modes)CodeMirror.modes.propertyIsEnumerable(o)&&s.push(o);for(t=0;t<s.length;t++)r[s[t]]=s[t];var u=[];for(var o in CodeMirror.mimeModes)CodeMirror.mimeModes.propertyIsEnumerable(o)&&u.push({mime:o,mode:CodeMirror.mimeModes[o]});for(t=0;t<u.length;t++)n=u[t].mime,i[n]=u[t].mime;for(var a in w)(w[a]in r||w[a]in i)&&(r[a]=w[a]);return function(t){return r[t]?CodeMirror.getMode(e,r[t]):null}}();void 0===t.highlightFormatting&&(t.highlightFormatting=!1),void 0===t.maxBlockquoteDepth&&(t.maxBlockquoteDepth=0),void 0===t.underscoresBreakWords&&(t.underscoresBreakWords=!0),void 0===t.fencedCodeBlocks&&(t.fencedCodeBlocks=!1),void 0===t.taskLists&&(t.taskLists=!1);var S=0,x="header",T="comment",N="quote",C="variable-2",k="variable-3",L="keyword",A="hr",O="tag",M="formatting",_="link",D="link",P="link",H="string",B="em",j="strong",F=/^([*\-=_])(?:\s*\1){2,}\s*$/,I=/^[*\-+]\s+/,q=/^[0-9]+\.\s+/,R=/^\[(x| )\](?=\s)/,U=/^#+/,z=/^(?:\={1,}|-{1,})$/,W=/^[^#!\[\]*_\\<>` "'(]+/,X=[],V={startState:function(){return{f:s,prevLineHasContent:!1,thisLineHasContent:!1,block:s,htmlState:null,indentation:0,inline:l,text:f,escape:!1,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,em:!1,strong:!1,header:0,taskList:!1,list:!1,listDepth:0,quote:0,trailingSpace:0,trailingSpaceNewLine:!1}},copyState:function(e){return{f:e.f,prevLineHasContent:e.prevLineHasContent,thisLineHasContent:e.thisLineHasContent,block:e.block,htmlState:e.htmlState&&CodeMirror.copyState(b,e.htmlState),indentation:e.indentation,localMode:e.localMode,localState:e.localMode?CodeMirror.copyState(e.localMode,e.localState):null,inline:e.inline,text:e.text,escape:!1,formatting:!1,linkTitle:e.linkTitle,em:e.em,strong:e.strong,header:e.header,taskList:e.taskList,list:e.list,listDepth:e.listDepth,quote:e.quote,trailingSpace:e.trailingSpace,trailingSpaceNewLine:e.trailingSpaceNewLine,md_inside:e.md_inside}},token:function(e,t){if(t.formatting=!1,e.sol()){var n=e.match(/^\s*$/,!0)||t.header;if(t.header=0,n)return t.prevLineHasContent=!1,i(t);t.prevLineHasContent=t.thisLineHasContent,t.thisLineHasContent=!0,t.escape=!1,t.taskList=!1,t.code=!1,t.trailingSpace=0,t.trailingSpaceNewLine=!1,t.f=t.block;var r=e.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length,s=4*Math.floor((r-t.indentation)/4);s>4&&(s=4);var o=t.indentation+s;if(t.indentationDiff=o-t.indentation,t.indentation=o,r>0)return null}return t.f(e,t)},innerMode:function(e){return e.block==o?{state:e.htmlState,mode:b}:e.localState?{state:e.localState,mode:e.localMode}:{state:e,mode:V}},blankLine:i,getType:a};return V},"xml"),CodeMirror.defineMIME("text/x-markdown","markdown"),function(){function e(e){var t=e.getWrapperElement();e.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:t.style.width,height:t.style.height},t.style.width="",t.style.height="auto",t.className+=" CodeMirror-fullscreen",document.documentElement.style.overflow="hidden",e.refresh()}function t(e){var t=e.getWrapperElement();t.className=t.className.replace(/\s*CodeMirror-fullscreen\b/,""),document.documentElement.style.overflow="";var n=e.state.fullScreenRestore;t.style.width=n.width,t.style.height=n.height,window.scrollTo(n.scrollLeft,n.scrollTop),e.refresh()}CodeMirror.defineOption("fullScreen",!1,function(n,r,i){i==CodeMirror.Init&&(i=!1),!i!=!r&&(r?e(n):t(n))})}();